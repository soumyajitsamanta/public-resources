head	1.2;
access;
symbols
	jpivot_1_8_0:1.2
	focus_1_6_0:1.2.0.4
	jpivot_1_7_0:1.2
	jpivot_1_6_0:1.2
	jpivot_1_5_0:1.2.0.2
	Root_jpivot_1_5_0:1.2
	mondrian_xmla_2005_08_25:1.1.0.2
	sourceforge_sync:1.2;
locks; strict;
comment	@# @;
expand	@k@;


1.2
date	2005.12.13.11.56.41;	author avix;	state Exp;
branches;
next	1.1;

1.1
date	2005.07.05.14.19.46;	author avix;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Synchronized with Tonbeller CVS:
  * Supports Mondrian 2.x API
  * Added BEA / Websphere Support
  * More tags in wcf tag library
  * Bugfixes
@
text
@/*
 * ====================================================================
 * This software is subject to the terms of the Common Public License
 * Agreement, available at the following URL:
 *   http://www.opensource.org/licenses/cpl.html .
 * Copyright (C) 2003-2004 TONBELLER AG.
 * All Rights Reserved.
 * You must accept the terms of that agreement to use this software.
 * ====================================================================
 *
 * 
 */
package com.tonbeller.jpivot.table;

import org.apache.log4j.Logger;
import org.w3c.dom.Element;

import com.tonbeller.jpivot.olap.model.Cell;
import com.tonbeller.jpivot.olap.model.Property;
import com.tonbeller.jpivot.table.span.PropertyUtils;

/**
 * Created on 18.10.2002
 * 
 * @@author av
 */
public class CellBuilderImpl extends PartBuilderSupport implements CellBuilder {

  private static final Logger logger = Logger.getLogger(CellBuilderImpl.class);
  private static final String STYLE = "style";
  private static final String NBSP = "\u00a0";
  /**
   * renders DOM element of cell
   */
  public Element build(Cell cell, boolean even) {
    Element cellElem = table.elem("cell");
    String s = cell.isNull() ? NBSP : cell.getFormattedValue();
    s = s.trim();
    if (s.length() == 0)
      s = NBSP;
    cellElem.setAttribute("value", s);
    if (logger.isDebugEnabled())
      logger.debug("building cell " + s);

    PropertyUtils.addProperties(cellElem, cell.getProperties());
    Property style = cell.getProperty(STYLE);
    if (style != null) {
      String value = style.getValue();
      if (value != null && value.length() > 0)
        cellElem.setAttribute(STYLE, value);
      else
        cellElem.setAttribute(STYLE, even ? "even" : "odd");
    }
    else 
      cellElem.setAttribute(STYLE, even ? "even" : "odd");

    return cellElem;
  }

}
@


1.1
log
@initial version
@
text
@d15 1
d20 1
a20 1
import com.tonbeller.jpivot.table.span.*;
d29 1
a29 1
  
d42 2
@

