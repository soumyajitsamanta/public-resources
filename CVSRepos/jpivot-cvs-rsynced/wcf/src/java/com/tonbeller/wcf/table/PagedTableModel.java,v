head	1.1;
access;
symbols
	jpivot_1_8_0:1.1
	focus_1_6_0:1.1.0.6
	wcf_1_7_0:1.1
	wcf_1_6_0:1.1
	jpivot_1_5_0:1.1.0.4
	Root_jpivot_1_5_0:1.1
	mondrian_xmla_2005_08_25:1.1.0.2
	sourceforge_sync:1.1;
locks; strict;
comment	@# @;


1.1
date	2005.07.05.14.04.58;	author avix;	state Exp;
branches;
next	;


desc
@@


1.1
log
@initial version
@
text
@/*
 * ====================================================================
 * This software is subject to the terms of the Common Public License
 * Agreement, available at the following URL:
 *   http://www.opensource.org/licenses/cpl.html .
 * Copyright (C) 2003-2004 TONBELLER AG.
 * All Rights Reserved.
 * You must accept the terms of that agreement to use this software.
 * ====================================================================
 *
 * 
 */
package com.tonbeller.wcf.table;

/**
 * a TableModel decorator that divides the table model into pages
 */
class PagedTableModel extends TableModelDecorator {
  private int pageSize = 10;
  private int currentPage;
  private boolean showAll = false;

  public PagedTableModel() {
  }

  public PagedTableModel(TableModel model) {
    super(model);
  }

  public int getRowCount() {
    if (showAll)
      return super.getRowCount();
    validate();
    int offs = currentPage * pageSize;
    int rows = super.getRowCount();
    if (offs + pageSize > rows)
      return rows - offs;
    return pageSize;
  }

  public TableRow getRow(int rowIndex) {
    if (showAll)
      return super.getRow(rowIndex);
    validate();
    return super.getRow(rowIndex + currentPage * pageSize);
  }

  public void setPageSize(int newPageSize) {
    pageSize = newPageSize;
    if (pageSize < 1)
      pageSize = 1;
  }

  public int getPageSize() {
    return pageSize;
  }

  public void setCurrentPage(int newCurrentPage) {
    currentPage = newCurrentPage;
  }

  public int getCurrentPage() {
    return currentPage;
  }

  public int getPageCount() {
    int rc = super.getRowCount();
    int pc = rc / pageSize;
    if ((rc % pageSize) != 0)
      pc += 1;
    return pc;
  }

  void validate() {
    int pageCount = getPageCount();
    if (currentPage >= pageCount)
      currentPage = pageCount - 1;
    if (currentPage < 0)
      currentPage = 0;
  }

  public void setShowAll(boolean newShowAll) {
    showAll = newShowAll;
  }

  public boolean isShowAll() {
    return showAll;
  }

  public void tableModelChanged(TableModelChangeEvent event) {
    currentPage = 0;
    validate();
  }

}@
