head	1.1;
access;
symbols
	jpivot_1_8_0:1.1
	focus_1_6_0:1.1.0.6
	wcf_1_7_0:1.1
	wcf_1_6_0:1.1
	jpivot_1_5_0:1.1.0.4
	Root_jpivot_1_5_0:1.1
	mondrian_xmla_2005_08_25:1.1.0.2
	sourceforge_sync:1.1;
locks; strict;
comment	@# @;


1.1
date	2005.07.05.14.04.28;	author avix;	state Exp;
branches;
next	;


desc
@@


1.1
log
@initial version
@
text
@package com.tonbeller.tbutils.res;

import java.util.Locale;

import javax.servlet.ServletContext;
import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;
import javax.servlet.jsp.jstl.core.Config;

import org.apache.log4j.Logger;

/**
 * sets the locale for JSTL tags
 * 
 * @@author av
 */
public class ResourcesFactoryContextListener implements ServletContextListener {

  private static Logger logger = Logger.getLogger(ResourcesFactoryContextListener.class);

  public void contextInitialized(ServletContextEvent e) {
    try {
      Locale fixedLocale = ResourcesFactory.instance().getFixedLocale();
      // if appLocale is set, make locale available to JSTL tags
      if (fixedLocale != null) {
        logger.info("setting application locale to " + fixedLocale);
        ServletContext sc = e.getServletContext();
        Config.set(sc, Config.FMT_LOCALE, fixedLocale);
      }
    } catch (Exception ex) {
      logger.error("Initialize Factory", ex);
    }
  }

  public void contextDestroyed(ServletContextEvent e) {
  }

}@
