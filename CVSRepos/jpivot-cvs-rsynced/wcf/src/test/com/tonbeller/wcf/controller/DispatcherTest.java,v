head	1.1;
access;
symbols
	jpivot_1_8_0:1.1
	focus_1_6_0:1.1.0.6
	wcf_1_7_0:1.1
	wcf_1_6_0:1.1
	jpivot_1_5_0:1.1.0.4
	Root_jpivot_1_5_0:1.1
	mondrian_xmla_2005_08_25:1.1.0.2
	sourceforge_sync:1.1;
locks; strict;
comment	@# @;


1.1
date	2005.07.05.14.05.01;	author avix;	state Exp;
branches;
next	;


desc
@@


1.1
log
@initial version
@
text
@package com.tonbeller.wcf.controller;

import java.util.HashMap;
import java.util.Map;

import junit.framework.TestCase;

/**
 */

public class DispatcherTest extends TestCase {

  DispatcherSupport disp;
  int count;

  class MyListener implements RequestListener {
    public void request(RequestContext context) {
      ++ count;
    }
  }

  public DispatcherTest(String name) {
    super(name);
  }
  public static void main(String[] args) {
    junit.textui.TestRunner.run(DispatcherTest.class);
  }

  public void setUp() {
    disp = new DispatcherSupport();
    count = 0;
  }

  public void testLookup() throws Exception {
    disp.addRequestListener("name1", "value1", new MyListener());
    disp.addRequestListener(null, "value2",    new MyListener());
    disp.addRequestListener("name3", null,  new MyListener());
    disp.addRequestListener(null, null,  new MyListener());
    disp.addRequestListener("name5", null, new MyListener());

    check("name1", "value1", 2);
    check("xxx", "value2", 2);
    check("name3", "xxx", 2);
    check("xxx", "xxx", 1);
    check("name5", "123", 2);
    // image button support: default listener and name5 listener will fire.
    check("name5.x", "123", 2);
  }

  private void check(String name, String value, int size) {
    Map map = new HashMap();
    map.put(name, new String[]{value});
    assertEquals(size, disp.findAll(map).size());
  }
}@
