head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2008.05.17.15.43.49;	author fsaz;	state dead;
branches;
next	1.1;

1.1
date	2005.11.28.14.02.36;	author fsaz;	state Exp;
branches;
next	;


desc
@@


1.2
log
@borrando viejos
@
text
@<?xml version="1.0" encoding="UTF-8"?>
<project name="JRubik build file" default="all" basedir=".">
<!--
<project name="JRubik build file" default="help" basedir=".">
-->
	<property name="app.name" value="JRubik"/>
	<property name="app.version" value="0.8.1"/>

	<property name="build.home" value="${basedir}/build"/>

	<property name="src-boot.home" value="source-boot"/>
	
	<property name="lib.jpf" value="lib/jpf-0.7.jar"/>
	<property name="lib.jpf-tools" value="lib/jpf-tools-0.7.jar"/>	

	<property name="lib.commons-logging" value="lib/commons-logging.jar"/>
	<property name="lib.log4j" value="lib/log4j-1.2.9.jar"/>
	<property name="lib.jxp" value="lib/jxp-1.2.0.jar"/>
	<property name="lib.looks" value="lib/looks-1.2.2.jar"/>

	<path id="classpath">
		<pathelement path="${lib.jpf}"/>
		<pathelement path="${lib.jpf-tools}"/>
		<pathelement path="${lib.commons-logging}"/>
		<pathelement path="${lib.log4j}"/>
		<pathelement path="${lib.jxp}"/>
		<pathelement path="${lib.looks}"/>
	</path>
	
	<typedef resource="org/java/plugin/tools/ant/jpf-tasks.properties">
		<classpath refid="classpath"/>
	</typedef>
	
	<target name="help">
		<echo><![CDATA[
${app.name} build file:
dist-bin - creates binary distribution package
dist-src - creates source distribution package
all      - runs all main tasks
test     - runs some tests
]]></echo>
	</target>
	
	<target name="clean">
		<tstamp>
			<format property="dt-stamp" pattern="yyyy-MM-dd-HH-mm"/>
			<format property="d-stamp" pattern="yyyy-MM-dd"/>
		</tstamp>
		<delete dir="${build.home}" quiet="true"/>
	</target>
	
	<target name="init" depends="clean">
		<mkdir dir="${build.home}"/>
	</target>

	<target name="build-boot">
		<mkdir dir="${build.home}/classes"/>
		<javac
			destdir="${build.home}/classes"
			srcdir="${src-boot.home}"
			classpathref="classpath"
			excludes=""
			debug="true"
			optimize="false">
		</javac>
		<mkdir dir="${build.home}/lib"/>
		<jar destfile="${build.home}/${app.name}.jar">
			<manifest>
				<attribute name="Main-Class" value="org.jpf.demo.toolbox.Boot"/>
				<attribute name="Class-Path" value="${lib.jpf} ${lib.jpf-tools} ${lib.commons-logging} ${lib.log4j} ${lib.jxp} ${lib.looks}"/>
			</manifest>
			<fileset dir="${build.home}/classes"/>
			<fileset dir="${src-boot.home}" excludes="**/*.java,**/*.jpage,**/.*"/>
		</jar>
		<delete dir="${build.home}/classes"/>
	</target>

	<target name="build-plugins">
		<property name="plugins.home" value="${build.home}/plugins"/>
		<ant dir="plugins/es.aeat.eett.workbench.core" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.core" target="${target}" inheritall="true"/>
		<ant dir="plugins/org.jpf.demo.toolbox.pluginbrowser" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.menu" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.chart" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.tableRubik" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.treeNavi" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.memoryPanel" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.basicStat" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.drillThrough" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.toolBarNavi" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.workbench.toolBarViews" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.mdx" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.statusBar" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.workbench.printer" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.export" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.map" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.helpMenu" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.infoRubik" target="${target}" inheritall="true"/>
		<ant dir="plugins/es.aeat.eett.rubik.calculator" target="${target}" inheritall="true"/>
	</target>
	
	<target name="check" description="Checks plug-ins integrity">
		<jpf-check
			basedir="${basedir}/plugins"
			includes="*/plugin.xml,*/plugin-fragment.xml"
			verbose="true"
			usepathresolver="true"/>
	</target>

	<target name="docs" depends="init" description="Generates plug-ins documentation">
		<jpf-doc
			basedir="${basedir}/plugins"
			includes="*/plugin.xml,*/plugin-fragment.xml"
			destdir="${build.home}/docs"/>
	</target>

	<target name="dist-bin" depends="init" description="Creates binary distribution package">
		<antcall target="build-boot"/>
		<copy todir="${build.home}/lib">
			<fileset dir="lib" includes="*.jar"/>
		</copy>
		<antcall target="build-plugins">
			<param name="target" value="dist-bin"/>
		</antcall>
		<jpf-check
			basedir="${build.home}/plugins"
			includes="*/*.xml"
			verbose="true"
			usepathresolver="true"/>
		<jpf-doc
			basedir="${build.home}/plugins"
			includes="*/*.xml"
			destdir="${build.home}/docs"/>
		<mkdir dir="${build.home}/data"/>
		<mkdir dir="${build.home}/data/resources"/>
		<copy todir="${build.home}/data/resources">
			<fileset dir="${basedir}/data/resources" includes="**/*.*"/>
		</copy>
		
		<mkdir dir="${build.home}/logs"/>
		<copy todir="${build.home}">
			<fileset dir="${basedir}" includes="*.*" excludes=".*,build*,run-dev*"/>
		</copy>
    	<zip destfile="${basedir}/../${app.name}-bin-${app.version}.zip" duplicate="fail" update="false">
    		<fileset dir="${build.home}" includes="**/*"/>
    	</zip>
    	<antcall target="clean"/>
	</target>

    <target name="dist-src" depends="init" description="Creates source distribution package">
       	<zip destfile="${basedir}/../${app.name}-src-${app.version}.zip" duplicate="fail" update="false">
    		<fileset dir="${basedir}" excludes="build,**/*.log,**/classes/**,*.zip,data/es.*/**"/>
    	</zip>
    	<antcall target="clean"/>
    </target>
    
    <target name="all" depends="dist-bin,dist-src" description="Runs all main tasks"></target>

	<target name="test" depends="init" description="Some tests">
		<jpf-pack
			basedir="${basedir}/plugins"
			includes="*/plugin.xml,*/plugin-fragment.xml"
			destfile="${build.home}/all-plugins.jpa"/>
		<mkdir dir="${build.home}/all-plugins-extracted"/>
		<jpf-unpack
			srcfile="${build.home}/all-plugins.jpa"
			destdir="${build.home}/all-plugins-extracted"/>
	</target>
</project>
@


1.1
log
@*** empty log message ***
@
text
@@

