head	1.24;
access;
symbols;
locks; strict;
comment	@# @;


1.24
date	2003.02.26.13.21.32;	author jiri_schmid;	state dead;
branches;
next	1.23;

1.23
date	2003.02.25.16.46.02;	author jiri_schmid;	state Exp;
branches;
next	1.22;

1.22
date	2003.02.25.09.18.00;	author jiri_schmid;	state Exp;
branches;
next	1.21;

1.21
date	2003.02.24.15.31.08;	author jiri_schmid;	state Exp;
branches;
next	1.20;

1.20
date	2003.02.21.15.15.02;	author jiri_schmid;	state Exp;
branches;
next	1.19;

1.19
date	2003.02.21.13.33.41;	author jiri_schmid;	state Exp;
branches;
next	1.18;

1.18
date	2003.02.19.16.06.46;	author jiri_schmid;	state Exp;
branches;
next	1.17;

1.17
date	2003.02.19.13.11.09;	author jiri_schmid;	state Exp;
branches;
next	1.16;

1.16
date	2003.02.17.09.58.18;	author jiri_schmid;	state Exp;
branches;
next	1.15;

1.15
date	2003.02.14.09.12.46;	author jiri_schmid;	state Exp;
branches;
next	1.14;

1.14
date	2003.02.11.16.06.56;	author jiri_schmid;	state Exp;
branches;
next	1.13;

1.13
date	2003.02.06.12.57.51;	author jiri_schmid;	state Exp;
branches;
next	1.12;

1.12
date	2003.02.03.09.25.22;	author jiri_schmid;	state Exp;
branches;
next	1.11;

1.11
date	2003.01.30.12.50.40;	author jiri_schmid;	state Exp;
branches;
next	1.10;

1.10
date	2003.01.30.06.36.20;	author michald;	state Exp;
branches;
next	1.9;

1.9
date	2003.01.27.16.38.43;	author jiri_schmid;	state Exp;
branches;
next	1.8;

1.8
date	2003.01.27.10.12.06;	author jiri_schmid;	state Exp;
branches;
next	1.7;

1.7
date	2003.01.24.16.34.21;	author jiri_schmid;	state Exp;
branches;
next	1.6;

1.6
date	2003.01.24.14.48.41;	author jiri_schmid;	state Exp;
branches;
next	1.5;

1.5
date	2003.01.23.16.43.00;	author spanhel;	state Exp;
branches;
next	1.4;

1.4
date	2003.01.23.09.47.23;	author spanhel;	state Exp;
branches;
next	1.3;

1.3
date	2003.01.21.14.17.55;	author spanhel;	state Exp;
branches;
next	1.2;

1.2
date	2003.01.21.11.02.56;	author spanhel;	state Exp;
branches;
next	1.1;

1.1
date	2003.01.18.12.23.06;	author michald;	state Exp;
branches;
next	;


desc
@@


1.24
log
@huge javascript optimalization, also files moved to directory js
@
text
@// $Id: dad.js,v 1.23 2003/02/25 16:46:02 jiri_schmid Exp $

var default_image="transparentpixel.gif";
var browserversion = 0.0;
var browsertype = 0;				// 0: unknown; 1:IE; 2:NN
var imgID;					//variable for manipulating image among frames
var divID;
var plusleft, plustop, posleft, postop = 0;	//iframe offset, global vars for actual mouse position
var mg = "-METRICS-";			//the special name for automatically generated Metric object
var mg_alert = "Please, insert the Metrics group item first."; //alert message

//checking what kind of browser is viewing the page
function browserdetect() {
var agt= navigator.userAgent.toLowerCase();
var appVer= navigator.appVersion.toLowerCase();
browserversion= parseFloat(appVer);
var iePos= appVer.indexOf('msie');
 if (iePos!=-1) browserversion= parseFloat(appVer.substring(iePos+5, appVer.indexOf(';',iePos)));
var nav6Pos = agt.indexOf('netscape6');
  if (nav6Pos!=-1) browserversion= parseFloat(agt.substring(nav6Pos+10))
  browsertype= (iePos!=-1) ? 1 : (agt.indexOf('mozilla')!=-1) ? 2 : 0;
return(browsertype>0); }

browserdetect();

//change the backgroundColor of table cell, which is nedded to be highlighted, webbrowser-TD active(this);
function active(EID){
var decided = browsertype;
if (EID.firstChild.name.match(/\w$/) == "M") decided += 4;
switch (decided) {
	case 1: {EID.style.background = "#d8f2ff"; return;}
	case 2: {EID.style.backgroundColor = "#d8f2ff"; return;}
	case 5: {EID.style.background = "#ffffd8"; return; }
	case 6: {EID.style.backgroundColor = "#ffffd8"; return;}
break;}}

//reverse action to active(), webbrowser-TD passive(this);
function passive(EID){
if (browsertype == 2) {EID.style.backgroundColor = "inherit"; return;}	else  {EID.style.background = ""; return;} }

//change the backgroundColor of table special_cell, which is nedded to be highlighted, webbrowser-TD active_special(this);
function active_special(EID){
if (EID.name != "" && browsertype == 2) {EID.name = EID.style.backgroundColor;}
	else {EID.name = EID.style.background;}
if (browsertype == 2)
	if (EID.className == "metrics_special") 
		{ EID.style.backgroundColor = "#ffffd8"; return; }
	else 	{ EID.style.backgroundColor = "#d8f2ff"; return; }
else
	if (EID.className == "metrics_special") 
		{ EID.style.background = "#ffffd8"; return;}
	else	{ EID.style.background = "#d8f2ff"; return;}}

//reverse action to active_special(), webbrowser-TD passive_special(this);
function passive_special(EID){ 
 if (browsertype == 2) {EID.style.backgroundColor = "";} 
 else
 	if (EID.className == "metrics_special") {EID.style.background = "#ffffbb";}
	else {EID.style.background = "#a8daff";} }

//get the iframe offset, initialize movebale image in actual frame, webbrowser-BODY ( [manualy defined name of i_frame] );
function init_var(i_frame) {
if (i_frame)
 { imgID = parent.document.getElementById("mainimg");
   divID = parent.document.getElementById("maindiv");
   var hlp = parent.document.getElementById(i_frame);}
 else { imgID = document.getElementById("mainimg");
 	divID = document.getElementById("maindiv");}
switch (browsertype) {
      case 1:
        document.onmousemove=mousemoveIE;
	break;
      case 2:
        document.captureEvents(Event.MOUSEMOVE);
	document.onmousemove=mousemoveNS;
	break; }
if (hlp) {
	if (hlp.style) {
	 plusleft = parseInt(hlp.style.left)+6;
	 plustop = parseInt(hlp.style.top)+6;}
	else {
	 plusleft = parseInt(hlp.left)+6;
	 plustop = parseInt(hlp.top)+6;}}
  else { 
   plusleft = 6;
   plustop = 6;}
//if (i_frame == "tree_iframe") alert(document.ID.value);
}

//check if the clicked ikon can be shown by dragging, 0 can be draged, 1 can't, called from show_me()
function check_show(element){
var typ = element.match(/[^\|]*$/);
switch (parent.document.getElementById("tree_iframe").name) {
 	case "G": if (typ == "A" || typ == "Af" || typ == "M") {return(0);} else return(1);
	case "M": if (typ == "A" || typ == "Af" || typ == "Fi" || typ == "M" || typ == "Fa") {return(0);} else return(1);
	case "R": if (typ == "G" || typ == "Fo" || typ == "Fi") {return(0);} else return(1);
	case "Fi":if (typ == "A" || typ == "Af" || typ == "Fa" || typ == "M") {return(0);} else return(1);
break;	}}

//show the clicked icon, webbrowser-IMG show_me(this) | also called from remove_me()
function show_me(EID){
if (divID.name == mg + "|A") {alert(mg_alert); return(false);}
if (check_show(EID.name) == 0)
  {divID.name = EID.name;
   divID.innerHTML = "<img src='"+EID.src+"'>"+EID.name.match(/^[^\|]*/);
   imgID.src = EID.src;
      	if (divID.style.visibility == "hidden")	{ divID.style.visibility = "visible"; moveimg();}
  }
 else {	hide_me(); } }

//show the icon of clicked item, webbrowser-A show_me_ex(id,typ) | also called from remove_me()
function show_me_ex(item_id){
var EID = document.getElementById("icon"+item_id);
if (divID.name == mg + "|A") {alert(mg_alert); return(false);}
if (check_show(EID.name) == 0)
  {if (get_type(item_id) == "Af")		//get_type(item_id) is defined in tree2.js
  	{var hlp = document.getElementById("act_it").text;
	 EID.name = hlp.match(/[^\|]*$/) + "." + hlp.match(/^[^\|]*/) + "|Af";}
   divID.name = EID.name;
   divID.innerHTML = "<img src='"+EID.src+"'>"+EID.name.match(/^[^\|]*/);
   imgID.src = EID.src;
      	if (divID.style.visibility == "hidden")	{ divID.style.visibility = "visible"; moveimg();}
  }
 else {	hide_me(); }}


//hide the dragged object, after drop or else, webbrowser window.event.onclick (registered event) 
function hide_me() { 
if (divID.style.visibility == "visible")
 if (divID.name == mg+"|A")
  {window.status="Sorry, illegal operation."}
 else {	divID.style.visibility="hidden";
 	window.status="";}
 else window.status="";}

//decide what to do afer clicking on table cell|row in visual managing table on GRID page, (drop/remove), webbrowser-TD|TR decide(this);
function decide(EID){
if ( EID.rowIndex >= 0)
  {if (divID.style.visibility == "visible" ) drop_me(EID);}
else
  {
  if (divID.style.visibility == "visible" ) drop_me(EID.parentNode)
  else remove_me(EID.parentNode,EID.firstChild);
  }}

//function for removing the automaticaly generated object Metric Group, called from remove_me()
function remove_mg(){
var row = document.getElementById(mg);
row.parentNode.deleteRow(row.rowIndex);
return;}

//remove table row from parent table and show dragging icon defined by EID, called from decide();
function remove_me(active_row,EID){
if (EID.name.match(/\w$/) == "M" && active_row.parentNode.rows.length == 3) remove_mg();
var active_table = active_row.parentNode;
if (active_row.id) imgID.alt = active_row.id;
active_table.deleteRow(active_row.rowIndex);
object_changed();
show_me(EID);}

//check if the clicked ikon can be shown by dragging,0 can be draged, 1 can't, called from drop_input() | drop_textarea()
function check_input_area(EID){
var typ = divID.name.match(/[^\|]*$/);
switch (parent.document.getElementById("tree_iframe").name) {
	case "M":
		switch (EID.id) {
			case "metric_attributes" : if (typ == "A" || typ == "Af") {return(0);} else return(1);
			case "metric_filter" : if (typ == "Fi") {return(0);} else return(1);
			case "metric_metric" : if (typ == "M" || typ == "Fa" || typ == "A" || typ == "Af") {return(0);} else return(1);
			default: return(1);
		break;}
	case "R":
		switch (EID.id) {
			case "report_filter" : if (typ == "Fi"){return(0);} else return(1);
			case "report_grid"   : if (typ == "G") {return(0);} else return(1);
			case "report_format" : if (typ == "Fo"){return(0);} else return(1);
			default: return(1);
		break;}
	case "Fi":
		switch (EID.id) {
			case "filter_filter" : if (typ == "M" || typ == "Fa" || typ == "A" || typ == "Af") {return(0);} else return(1);
			default: return(1);
		break;}
	default: return(1);
break;}}

//drop the object into input field, webbrowser-INPUT drop_input(this)
function drop_input(EID){
if (divID.style.visibility == "hidden") return;
var insert = divID.name.match(/^[^\|]*/);
if (check_input_area(EID) == 0) 
 { EID.value = insert;
   object_changed();}
} //hide_me(); function registered by body.onclick

//drop the object into textarea field, webbrowser-INPUT drop_text_area(this)
function drop_textarea(EID){
if (divID.style.visibility == "hidden") return;
var insert = divID.name.match(/^[^\|]*/);
if (check_input_area(EID) == 0) {
	if (EID.value.match(/(..)$/g) == "()") EID.value = EID.value.replace(/.$/g,("[" + insert + "])"))
	 else EID.value = EID.value + "[" + insert + "]";
	object_changed();}
} //hide_me(); function registered by body.onclick

//check if the dropped object can be inserted into parent table of active_row, called from drop_me()
function check_table(active_row){
//var hlp = document.getElementById("drop_area_1").innerHTML;
//if (hlp.indexOf(divID.name) > -1) return(1);
hlp = document.getElementById("drop_area_0").innerHTML;
if (hlp.indexOf(divID.name) > -1) { return(1)};
var table_section = active_row.parentNode;
var pole = divID.name.split("|");
 switch (parent.document.getElementById("tree_iframe").name) {
 	case "G":
		switch (pole[1]) {
			case "A" : if (table_section.parentNode.id != "drop_zone_metrics") {return(0);} else return(1); 
			case "Af": if (table_section.parentNode.id != "drop_zone_metrics") {return(0);} else return(1);
			case "M" : if (table_section.parentNode.id == "drop_zone_metrics")
					{ if (table_section.rows.length == 2) add_metric();
					  return(0);}
					else return(1);
			default: return(1);
		break;}}}

//automaticaly generate the Metric Group object, if inserted metrics = 2, called from drop_me() 
function add_metric(){
var active_table = document.getElementById("drop_zone_collumn");
var new_row = active_table.insertRow(active_table.rows.length-1);
new_row.id = mg;
 var new_cell = new_row.insertCell(0);
 new_cell.className="visual_up";
 new_cell.onclick = function() {decide(this);};
 new_cell.onmouseover = function() {active(this);};
 new_cell.onmouseout = function() {passive(this);};
  new_cell.innerHTML = "<img name='"+mg+"|A' src='"+imgID.src.replace(/\.gif$/,"_group.gif")+"'> "+mg;}

//drop the object into parent table of active_row, called from decide()
function drop_me(active_row){
var active_table = active_row.parentNode;
if ( check_table(active_row) == 0) {
 var new_row = active_table.insertRow(active_row.rowIndex); 
 if (imgID.alt != "") {new_row.id = imgID.alt; imgID.alt = "";} 
 var new_cell = new_row.insertCell(0);
 new_cell.className="visual_up";
 new_cell.onclick = function() {decide(this);};
 new_cell.onmouseover = function() {active(this);};
 new_cell.onmouseout = function() {passive(this);};
  var insert = divID.name.match(/^[^\|]*/);
  new_cell.innerHTML = "<img name='"+divID.name+"' src='"+imgID.src+"'> " + insert;
  //hide_me(); function registered by iframe drop - body.onclick
  divID.name="";
  object_changed();
}}

//move the icon when dragging - engine, called by mousemoveNS | mousemoveIE
function moveimg() {
posleft += plusleft; postop += plustop;
    if (divID) {
     if (divID.style) {
	divID.style.left= posleft+"px";
	divID.style.top= postop+"px";
      } else {
	divID.left= posleft;
	divID.top= postop; }}}

//move the icon when dragging, webbrowser window.event.onmousemove (registered event), for NN only
function mousemoveNS(e) {
posleft = e.pageX - window.pageXOffset;
postop = e.pageY - window.pageYOffset;
if (divID.style.visibility == "visible") moveimg();
return(false); }

//move the icon when dragging, webbrowser window.event.onmousemove (registered event), for IE only
function mousemoveIE() {
       posleft = event.clientX;
       postop = event.clientY;
       if (divID.style.visibility == "visible") moveimg();
return(false); }

// put item(s) from drag & drop table "Zone" into relevant SELECT object "Obj"
function fill_select_by_zone(Obj,Zone) {
var selectobj = document.getElementById(Obj);
selectobj.length = 0;
var hlp = document.getElementById(Zone).innerHTML;
var pole = hlp.match(/[^"=]*[\|]/g); // --> item| 
for (i in pole) 
	{ 	pole[i] = String(pole[i]).match(/.*[^\|]/); // item| --> item, String(pole[i]) - necessary for proper functionality on IE
		selectobj.options[i]= new Option(pole[i],pole[i],false,true);}
return(true);}

// before saving select all item in SELECT objects - PageObj, COlObj, RowObj, Metrics
function fill_selects(){
if (imgID.alt != "") {add_metric(); imgID.alt=""; divID.name="";}
       fill_select_by_zone("PageObj","drop_zone_page");
       fill_select_by_zone("ColObj","drop_zone_collumn");
       fill_select_by_zone("RowObj","drop_zone_row");
       fill_select_by_zone("Metrics","drop_zone_metrics");
       return(true);
}

//sets the value of hidden input element to changed (1), the item was edited
function object_changed(){document.getElementById("changed").value = 1;}
@


1.23
log
@removed unused functions from attr.js, language fixies in tabs.cgi and linked files
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.22 2003/02/25 09:18:00 jiri_schmid Exp $
@


1.22
log
@added checking of unsaved-changed item, when traying to start editing another one
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.21 2003/02/24 15:31:08 jiri_schmid Exp $
a281 1

d302 1
@


1.21
log
@new bugs just found fixed, some visual changes
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.20 2003/02/21 15:15:02 jiri_schmid Exp $
d158 1
d191 4
a194 1
if (check_input_area(EID) == 0) EID.value = insert;} //hide_me(); function registered by body.onclick
d202 3
a204 1
	 else EID.value = EID.value + "[" + insert + "]";}} //hide_me(); function registered by body.onclick
d252 3
a254 1
  divID.name=""; }}
d303 1
a303 7
// Special function for tuning/viewing variables on demand, by clicking the getSpecifiedData button
function getData(){
//alert(window.drop.document.getElementById("drop_zone_metrics").innerHTML);
var superpole = document.lastChild.innerHTML.split("\n");
for (i in superpole) alert(superpole[i]);
}

@


1.20
log
@visual improvments
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.19 2003/02/21 13:33:41 jiri_schmid Exp $
d205 1
a205 1
if (hlp.indexOf(divID.name) > -1) return(1);
d279 1
a279 1
var pole = hlp.match(/[^"|=]*[\|]/g); // --> item|,... 
@


1.19
log
@IE saving ULTRA BUG fixed, hope we fullfunctional on IE v. 5.0 and above| 6.0 tested
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.18 2003/02/19 16:06:46 jiri_schmid Exp $
d202 2
a203 2
var hlp = document.getElementById("drop_area_1").innerHTML;
if (hlp.indexOf(divID.name) > -1) return(1);
a279 1

d281 1
a281 1
	{ 	pole[i] = String(pole[i]).match(/.*[^\|]/); // item| --> item
@


1.18
log
@activating of new items fullfunctional, deleting also
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.17 2003/02/19 13:11:09 jiri_schmid Exp $
d274 1
d279 2
a280 2
var pole = hlp.match(/[^"]*[\|]/g); // --> item|,... 
//hlp.match(/[^"]*[\|][^"]*/g); --> item|type,....
d282 1
a282 1
	{ 	pole[i] = pole[i].match(/.*[^\|]/); // item| --> item
@


1.17
log
@opening the new item after its creating almost fullfunctional
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.16 2003/02/17 09:58:18 jiri_schmid Exp $
d112 1
a112 1
function show_me_ex(item_id,typ){
@


1.16
log
@added directory for javascript files, deleting items from tree controled by javascipt - tabs.js/check_drop()
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.15 2003/02/14 09:12:46 jiri_schmid Exp $
d116 1
a116 1
  {if (typ == "Af") 
@


1.15
log
@some code and visual improvment
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.14 2003/02/11 16:06:56 jiri_schmid Exp $
d87 1
d278 2
a279 1
var pole = hlp.match(/"[^"\|]*\|/g);
d281 1
a281 1
	{ 	pole[i] = pole[i].match(/[^"].*[^\|]/g);
@


1.14
log
@large rebuilding of format_ed.pl and linked files format[|_css|_graph].html,
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.13 2003/02/06 12:57:51 jiri_schmid Exp $
a98 8
//show the icon of clicked text, webbrowser-IMG show_by_text(this)
function show_by_text(EID){
var hlp = document.getElementById("icon"+EID.id);
if (hlp.name.match(/[^\|]*$/) == "Af" && hlp.name.indexOf(".") < 0)
 hlp.name = hlp.parentNode.name.match(/^[^\|]*/) + "." + hlp.name;
show_me(hlp);
}

d123 1
a123 1
 else {	hide_me(); } }
@


1.13
log
@some visual and control improvments
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.12 2003/02/03 09:25:22 jiri_schmid Exp $
d79 2
a80 2
	 plusleft = parseInt(hlp.style.left);
	 plustop = parseInt(hlp.style.top);}
d82 2
a83 2
	 plusleft = parseInt(hlp.left);
	 plustop = parseInt(hlp.top);}}
d85 2
a86 2
   plusleft = 0;
   plustop = 0;}
d99 1
a101 1
//alert();
d138 1
a138 1
  {window.status="Sorry, illegal operation./hide_me()"}
d237 1
a237 1
  new_cell.innerHTML = "<img name='"+mg+"|A' src='"+imgID.src.replace(/\.gif$/,"_group.gif")+"'>"+mg;}
d251 2
a252 2
  new_cell.innerHTML = "<img name='"+divID.name+"' src='"+imgID.src+"'>" + insert;
  //hide_me(); function registered by body.onclick
d257 1
a257 1
posleft += (6+plusleft); postop += (6+plustop);
@


1.12
log
@few MSIE visual bugs found and fixed
@
text
@d1 1
a1 1
// $Id: dad.js,v 1.11 2003/01/30 12:50:40 jiri_schmid Exp $
d99 9
a107 1
//show the clicked ikon, webbrowser-IMG show_me(this) | remove_me()
d118 16
d237 1
a237 1
  new_cell.innerHTML = "<img name='"+mg+"|A' src='"+imgID.src+"'>"+mg;}
d302 1
a302 1
function getSpecificData(){
d304 2
a305 1
alert("no data defined to view");
@


1.11
log
@Dad.js seems to be working properly
@
text
@d1 1
a1 1
// $Id: dad.js, Exp $
d29 1
a29 3
if (EID.name != "" && decide == 2) {EID.name = EID.style.backgroundColor;} else {EID.name = EID.style.background;}
if (parent.document.getElementById("tree_iframe").name == "G")
 {  if (EID.firstChild.name.match(/\w$/) == "M") decided += 4;}
d33 1
a33 1
	case 5: {EID.style.background = "#ffffd8"; return;}
d38 2
a39 1
function passive(EID){ if (browsertype == 2) {EID.style.backgroundColor = EID.name;} else {EID.style.background = EID.name;} }
d43 2
a44 1
if (EID.name != "" && browsertype == 2) {EID.name = EID.style.backgroundColor;} else {EID.name = EID.style.background;}
d55 5
a59 1
function passive_special(EID){ if (browsertype == 2) {EID.style.backgroundColor = EID.name;} else {EID.style.background = EID.name;} }
d156 3
a158 3
			case "report_filter" : if (typ == "Fi") {return(0);} else return(1);
			case "report_grid" : if (typ == "G") {return(0);} else return(1);
			case "report_format" : if (typ == "Fo") {return(0);} else return(1);
d163 1
a163 1
			case "filter_filter" : if (typ == "A" || typ == "Af" || typ == "Fa" || typ == "M") {return(0);} else return(1);
@


1.10
log
@functionality for saving and retrieving attribute displays and metric groups in grid editor
@
text
@d1 2
d7 1
d61 1
d63 2
a64 1
 else {imgID = document.getElementById("mainimg");}
d87 1
a87 1
var pole = element.split("|");
d89 4
a92 4
 	case "G": if (pole[1] == "A" || pole[1] == "Af" || pole[1] == "M") {return(0);} else return(1);
	case "M": if (pole[1] == "A" || pole[1] == "Af" || pole[1] == "Fi" || pole[1] == "M" || pole[1] == "Fa") {return(0);} else return(1);
	case "R": if (pole[1] == "G" || pole[1] == "Fo" || pole[1] == "Fi") {return(0);} else return(1);
	case "Fi":if (pole[1] == "A" || pole[1] == "Af" || pole[1] == "Fa" || pole[1] == "M") {return(0);} else return(1);
d97 4
a100 3
if (imgID.name == mg + "|A") {alert(mg_alert); return(false);}
if ( check_show(EID.name) == 0)
  {imgID.name = EID.name;
d102 1
a102 1
   	if (imgID.style.visibility == "hidden")	{ imgID.style.visibility = "visible"; moveimg();}
d106 10
a115 1
//decide what to do afer clicking on table cell|row in visual managing table on GRID page, (drop/remove), webbrowser-TD|TR (this);
d118 1
a118 1
  {if (imgID.style.visibility == "visible" ) drop_me(EID);}
d121 1
a121 1
  if (imgID.style.visibility == "visible" ) drop_me(EID.parentNode)
d141 1
a141 1
var pole = imgID.name.split("|");
d145 3
a147 3
			case "metric_attributes" : if (pole[1] == "A" || pole[1] == "Af") {return(0);} else return(1);
			case "metric_filter" : if (pole[1] == "Fi") {return(0);} else return(1);
			case "metric_metric" : if (pole[1] == "M" || pole[1] == "Fa" || pole[1] == "A" || pole[1] == "Af") {return(0);} else return(1);
d152 3
a154 3
			case "report_filter" : if (pole[1] == "Fi") {return(0);} else return(1);
			case "report_grid" : if (pole[1] == "G") {return(0);} else return(1);
			case "report_format" : if (pole[1] == "Fo") {return(0);} else return(1);
d159 1
a159 1
			case "filter_filter" : if (pole[1] == "A" || pole[1] == "Af" || pole[1] == "Fa" || pole[1] == "M") {return(0);} else return(1);
d167 3
a169 3
if (imgID.style.visibility == "hidden") return;
var pole = imgID.name.split("|");
if (check_input_area(EID) == 0) EID.value = pole[0]; } //hide_me(); function registered by body.onclick
d173 2
a174 2
if (imgID.style.visibility == "hidden") return;
var pole = imgID.name.split("|");
d176 2
a177 2
	if (EID.value.match(/(..)$/g) == "()") EID.value = EID.value.replace(/.$/g,("[" + pole[0] + "])"))
	 else EID.value = EID.value + "[" + pole[0] + "]";}} //hide_me(); function registered by body.onclick
d181 2
a182 2
 var hlp = document.getElementById("drop_area_1").innerHTML;
if (hlp.indexOf(imgID.name) > -1) return(1);
d184 1
a184 1
if (hlp.indexOf(imgID.name) > -1) return(1);
d186 1
a186 1
var pole = imgID.name.split("|");
d222 2
a223 2
  var pole = imgID.name.split("|");
  new_cell.innerHTML = "<img name='"+imgID.name+"' src='"+imgID.src+"'>" + pole[0];
d225 1
a225 10
  imgID.name=""; }}

//hide the dragged object, after drop or else, webbrowser window.event.onclick (registered event) 
function hide_me() { 
if (imgID.style.visibility == "visible")
 if (imgID.name == mg+"|A")
  {window.status="Sorry, illegal operation./hide_me()"}
 else {imgID.style.visibility="hidden";
 	window.status="";}
 else window.status="";}
d230 4
a233 4
    if (imgID) {
     if (imgID.style) {
	imgID.style.left= posleft+"px";
	imgID.style.top= postop+"px";
d235 2
a236 2
	imgID.left= posleft;
	imgID.top= postop; }}}
d242 1
a242 1
if (imgID.style.visibility == "visible") moveimg();
d249 1
a249 1
       if (imgID.style.visibility == "visible") moveimg();
d265 1
a265 1
if (imgID.alt != "") {add_metric(); imgID.alt=""; imgID.name="";}
@


1.9
log
@script improvment in dad.js, unexplaneabale visual bugs fixed by changing page structure of metrics_ed.pl, filter_ed.pl and report_ed.pl, visual improvment of Grid Page
@
text
@d6 1
a6 1
var mg = "Metrics Group";			//the special name for automatically generated Metric object
@


1.8
log
@previously added bug in dad.js removed, Metric gui improved
@
text
@d1 1
a1 1
var default_image="transparentpixel.gif"; //vychoyi obrazek
d3 5
a7 4
var browsertype = 0;	// 0: unknown; 1:IE; 2:NN
var imgID = "";		//objekt pronasledujici mys
var plusleft, plustop, posleft, postop = 0;	//odchylka iframe, pokud je 
var mg = "Metrics Group";
d9 1
d23 1
d25 25
a49 8
if (browsertype == 2) EID.style.backgroundColor = "#d8f2ff"
 else EID.style.background ="#d8f2ff";
}

function passive(EID){
if (browsertype == 2) EID.style.backgroundColor = "#5190e2";
  else EID.style.background ="#5190e2";
}
d51 2
a52 4
function passive_special(EID){
if (browsertype == 2) EID.style.backgroundColor = "#a8daff";
  else EID.style.background ="#a8daff";
}
d54 1
a59 3

// alert(imgID);

d80 2
a81 1
function check_show(element){		//0 - prevek neni obsazen, 1 -prvek je obsazen (chyba)
d84 1
a84 8
 	case "G":
		switch (pole[1]) {
			case "A" : return(0);
			case "Af": return(0);
			case "M" : return(0);
			//case "_M" : return(0);
			default: return(1);
		break;}
d87 2
a88 3
	case "Fi": if (pole[1] == "A" || pole[1] == "Af" || pole[1] == "Fa" || pole[1] == "M") {return(0);} else return(1);
break;
	}}
d90 3
a92 2
function show_me(EID){ 		//EID - identifikator img, ktery vyvolal show_me
if (imgID.name == mg + "|A") {alert("Please, insert the Metrics group item first."); return(false);}
d98 1
a98 2
 else {	hide_me(); } 
}
d100 1
d102 2
a103 5
if ( EID.rowIndex >= 0)				//EID - identif img, ktery vyvolal decide
  {
  if (imgID.style.visibility == "visible" ) drop_me(EID)
  else {window.status = "Sorry, illegel action.";}
  }
d108 1
a108 2
  }
}
d110 1
d114 1
a114 2
return;
}
d116 2
a117 1
function remove_me(active_row,EID){		//radek obsahujici bunku a id img, kt. vyvolal remove_me
d119 1
a119 1
var active_table = active_row.parentNode;	//tabulka obsh. radek
d121 1
a121 1
active_table.deleteRow(active_row.rowIndex);	//smazanai radku, ktery obsahuje img EID
d124 1
d148 1
a148 2
break;}
}
d150 1
d154 1
a154 6
if (check_input_area(EID) == 0) {
	EID.value = pole[0];
	imgID.style.visibility = "hidden";
	window.status="";}
 else window.status="Sorry, unisertable item";
}
d156 1
d161 2
a162 7
	if (EID.value.match(/(..)$/g) == "()")
		{ EID.value = EID.value.replace(/.$/g,("[" + pole[0] + "])"));}
	 else EID.value = EID.value + "[" + pole[0] + "]";
	imgID.style.visibility = "hidden";
	window.status=""; }
else window.status="Sorry, unisertable item";
}
d164 3
a166 2
function check_table(active_row){	//0 - prevek neni obsazen, 1 -prvek je obsazen (chyba)
 var hlp = document.getElementById("drop_area_1").innerHTML;	// je prvek v drop_area?
d168 1
a168 1
hlp = document.getElementById("drop_area_0").innerHTML;		// je prvek v drop_page?
d184 1
d187 1
a187 1
var new_row = active_table.insertRow(active_table.rows.length-1);	//vytvoreni noveho radku
d189 1
a189 1
 var new_cell = new_row.insertCell(0);				//vytvoreni nove bunky 
d194 1
a194 3
  new_cell.innerHTML = "<img name='"+mg+"|A' src='"+imgID.src+"'>"+mg;
  window.status="";
}
d196 1
d198 1
a198 1
var active_table = active_row.parentNode;			//tabulka obsh. radek s udalosti
d200 1
a200 1
 var new_row = active_table.insertRow(active_row.rowIndex); 	//vytvoreni noveho radku
d202 1
a202 1
 var new_cell = new_row.insertCell(0);				//vytvoreni nove bunky 
d209 2
a210 5
  imgID.style.visibility = "hidden";
  imgID.name = "empty";
  window.status="";}
  else window.status = "Sorry, non-isertable item.";
}
d212 1
d214 6
a219 4
if (imgID.style.visibility == "visible" && imgID.name != mg+"|A")	//pokud je objekt zobrazen, priprav se na jeho zmizeni nebo drop
  imgID.style.visibility = "hidden"					//img byl zmizen :)
  else window.status="Sorry, unerasble item.";
}					
d221 1
d230 1
a230 2
	imgID.top= postop; }}
}
d232 1
d239 1
d241 2
a242 2
       posleft = event.clientX;// - document.body.scrollLeft;
       postop = event.clientY;// - document.body.scrollTop;
d244 1
a244 3
return(false); 
}

d255 1
a255 2
return(true);
}
d259 1
a265 1

@


1.7
log
@minor bugs in dad.js fixed, some visual changes in interfaceoB
@
text
@d157 3
a159 1
	EID.value = EID.value + "[" + pole[0] + "]";
@


1.6
log
@*** empty log message ***
@
text
@d22 2
a23 2
if (browsertype == 2) EID.style.backgroundColor = "#1796ea"
 else EID.style.background ="#1796ea";
d27 2
a28 2
if (browsertype == 2) EID.style.backgroundColor = "#59b0f2";
  else EID.style.background ="#59b0f2";
@


1.5
log
@added object metric in grid_ed.pl
@
text
@a0 3
/*prime volani pro drop_me neni osetreno*/
/*chech (je ? neni) dopracovan*/

d6 1
d82 1
a82 1
if (imgID.name == "_Metrics_|A") {alert("Please, insert the _Metrics_ item first."); return(false);}
d104 2
a105 2
function remove_Metrics_(){
var row = document.getElementById("_Metrics_");
d111 1
a111 1
if (EID.name.match(/\w$/) == "M" && active_row.parentNode.rows.length == 3) remove_Metrics_();
d113 1
a113 1
if (active_row.id) imgID.id = active_row.id;
d124 1
a124 1
			case "metric_metric" : if (pole[1] == "M" || pole[1] == "Fa") {return(0);} else return(1);
a174 1
			//case "_M": if (table_section.parentNode.id != "drop_zone_metrics") {return(0);} else return(1); 
d185 1
a185 1
new_row.id = "_Metrics_";
d191 1
a191 1
  new_cell.innerHTML = "<img name='_Metrics_|A' src='"+imgID.src+"'>_Metrics_"; //typ: A ? _M
d199 1
a199 1
 if (imgID.id != "") {new_row.id = imgID.id; imgID.id = "";} 
d214 1
a214 1
if (imgID.style.visibility == "visible" && imgID.name != "_Metrics_|A")	//pokud je objekt zobrazen, priprav se na jeho zmizeni nebo drop
d265 2
a266 2
/*
// Special function for tuning/viewing variables on demand, by clicking the super button
d268 2
a269 3
var hlp = document.getElementById("drop_zone_collumn").innerHTML;
var pole = hlp.match(/"[^"\|]*\|/g);
for (i in pole) {alert(pole[i].match(/[^"].*[^\|]/g));}
d271 1
a271 1
*/
@


1.4
log
@removed ID used by Drag and Drop
@
text
@a37 11
function moveimg() {
posleft += (6+plusleft); postop += (6+plustop);
    if (imgID) {
      if (imgID.style) {
	imgID.style.left= posleft+"px";
	imgID.style.top= postop+"px";
      } else {
	imgID.left= posleft;
	imgID.top= postop; }}
}

d40 6
a45 2
 imgID = parent.document.getElementById("mainimg")
 else imgID = document.getElementById("mainimg");
d53 1
a53 5
	break;
    }
if (i_frame)
{
var hlp = parent.document.getElementById(i_frame);
a54 1
	i_height = hlp.height;
d60 4
a63 2
	 plustop = parseInt(hlp.top);}
	}}
d84 1
d86 1
a86 1
 { imgID.name = EID.name;
d88 3
a90 5
   if (imgID.style.visibility == "hidden")
   { imgID.style.visibility = "visible";
     moveimg();}
}
 else {	hide_me(); }
d106 6
d113 1
d115 1
d146 1
d156 1
d188 1
d202 1
d211 1
d213 1
a213 1
  else window.status = "Sorry, unisertable item";
d217 15
a231 2
if (imgID.style.visibility == "visible")	//pokud je objekt zobrazen, priprav se na jeho zmizeni nebo drop
  imgID.style.visibility = "hidden";}		//img byl zmizen :)
d240 2
a241 2
       posleft = event.clientX-document.body.scrollLeft;
       postop = event.clientY-document.body.scrollTop;
d268 1
a273 3


//alert(document.getElementById("drop_area_1").innerHTML);
d275 1
@


1.3
log
@load metadata to grid_ed.pl
@
text
@d8 1
a8 4
var plusleft = 0;	//odchylka iframe, pokud je 
var plustop = 0;	//odchylka iframe, pokud je
var firstclick = 0;
var posleft, postop = 0;
d66 4
a69 3
      if (hlp.style) {
	plusleft = parseInt(hlp.style.left);
	plustop = parseInt(hlp.style.top);}
d71 2
a72 2
	plusleft = parseInt(hlp.left);
	plustop = parseInt(hlp.top);}
d80 1
a80 1
		switch (pole[2]) {
d84 1
d87 3
a89 3
	case "M": if (pole[2] == "A" || pole[2] == "Af" || pole[2] == "Fi" || pole[2] == "M" || pole[2] == "Fa") {return(0);} else return(1);
	case "R": if (pole[2] == "G" || pole[2] == "Fo" || pole[2] == "Fi") {return(0);} else return(1);
	case "Fi": if (pole[2] == "A" || pole[2] == "Af" || pole[2] == "Fa" || pole[2] == "M") {return(0);} else return(1);
d101 1
a101 1
 else window.status = "unisertable item"; 
d104 6
a109 3
function decide(EID){ 				//EID - identif img, ktery vyvolal decide
if ( imgID.style.visibility == "visible" ) 	//objekt je pretahovan
  drop_me(EID.parentNode)			//radek obsahujici img
d111 5
a115 1
 delete_me(EID.parentNode,EID.firstChild)}	
d117 1
a117 1
function delete_me(active_row,EID){		//radek obsahujici bunku a id img, kt. vyvolal delete_me
d127 3
a129 3
			case "metric_attributes" : if (pole[2] == "A" || pole[2] == "Af") {return(0);} else return(1);
			case "metric_filter" : if (pole[2] == "Fi") {return(0);} else return(1);
			case "metric_metric" : if (pole[2] == "M" || pole[2] == "Fa") {return(0);} else return(1);
d134 3
a136 3
			case "report_filter" : if (pole[2] == "Fi") {return(0);} else return(1);
			case "report_grid" : if (pole[2] == "G") {return(0);} else return(1);
			case "report_format" : if (pole[2] == "Fo") {return(0);} else return(1);
d141 1
a141 1
			case "filter_filter" : if (pole[2] == "A" || pole[2] == "Af" || pole[2] == "Fa" || pole[2] == "M") {return(0);} else return(1);
d151 1
a151 1
	EID.value = pole[1];
d154 1
a154 1
 else window.status="Unisertable item";
d160 1
a160 1
	EID.value = EID.value + pole[1];
d163 1
a163 1
else window.status="Unisertable item";
a166 1
var pole = imgID.name.split("|");
d168 1
a168 1
if (hlp.indexOf(pole[0]) > -1) return(1);
d170 1
a170 1
if (hlp.indexOf(pole[0]) > -1) return(1);
d172 1
d175 1
a175 1
		switch (pole[2]) {
d177 6
a182 2
			case "Af": if (table_section.parentNode.id != "drop_zone_metrics") {return(0);} else return(1); 
			case "M" : if (table_section.parentNode.id == "drop_zone_metrics") return(0);
d185 13
a197 1
		
d200 1
a200 1
if ( check_table(active_row) == 0 ) {
d207 2
a208 2
  new_cell.innerHTML = "<img name='"+imgID.name+"' src='"+imgID.src+"'>" +
  imgID.name.substring(imgID.name.indexOf("|")+1,imgID.name.lastIndexOf("|")); //naplneni nove bunky
d211 1
a211 1
  else window.status = "Alredy inserted item";
d219 2
a220 2
posleft = e.pageX;
postop = e.pageY;
d225 2
a226 2
       posleft = event.clientX+document.body.scrollLeft;
       postop = event.clientY+document.body.scrollTop;
d234 8
a241 13
       var selectobj = document.getElementById(Obj);
       selectobj.length = 0;
       var hlp = document.getElementById(Zone);
       var num = (hlp.rows.length+(hlp.rows.length-1));
       var pole = new Array(num);
       pole = hlp.innerHTML.split("|");
       for (var i=0; i < num; i++) {
       		if ( (i%2)==1) {
  			hlp = new Option(pole[i],pole[i],false,true);
			selectobj.options[selectobj.options.length]= hlp;
		}
       };
       return(true);
d251 10
@


1.2
log
@drag and drop + lang version - /lang/lang.def
@
text
@d88 3
a90 1
	case "M": if (pole[2] == "A" || pole[2] == "Af" || pole[2] == "Fi" || pole[2] == "M") {return(0);} else return(1);
d116 1
a116 1
function check_input(EID){
d123 13
a135 1
			case "metric_metric" : if (pole[2] == "M") {return(0);} else return(1);
d144 1
a144 1
if (check_input(EID) == 0) {
d146 3
a148 1
	imgID.style.visibility = "hidden"; }
d153 1
a153 1
if (check_input(EID) == 0) {
d155 3
a157 1
	imgID.style.visibility = "hidden"; }
d187 3
a189 1
  imgID.style.visibility = "hidden";}
@


1.1
log
@edit_obj with drag/drop functionality
@
text
@d26 15
d79 1
a79 1
var pole = new Array(3); pole = element.split("|");
d87 4
a90 1
		break;}}}
a102 17
function check_drop(active_row){	//0 - prevek neni obsazen, 1 -prvek je obsazen (chyba)
var pole = new Array(3);
pole = imgID.name.split("|");
 var hlp = document.getElementById("drop_area_1").innerHTML;	// je prvek v drop_area?
if (hlp.indexOf(pole[0]) > -1) return(1);
hlp = document.getElementById("drop_area_0").innerHTML;		// je prvek v drop_page?
if (hlp.indexOf(pole[0]) > -1) return(1);
var table_section = active_row.parentNode;
 switch (parent.document.getElementById("tree_iframe").name) {
 	case "G":
		switch (pole[2]) {
			case "A" : if (table_section.parentNode.id != "drop_zone_metrics") {return(0);} else return(1); 
			case "Af": if (table_section.parentNode.id != "drop_zone_metrics") {return(0);} else return(1); 
			case "M" : if (table_section.parentNode.id == "drop_zone_metrics") return(0);
			default: return(1);
		break;}}}

d114 12
a125 3
function active(EID){
if (browsertype == 2) EID.style.backgroundColor = "#1796ea"
 else EID.style.background ="#1796ea";
d128 5
a132 3
function passive(EID){
if (browsertype == 2) EID.style.backgroundColor = "#59b0f2";
  else EID.style.background ="#59b0f2";
d135 5
a139 3
function passive_special(EID){
if (browsertype == 2) EID.style.backgroundColor = "#a8daff";
  else EID.style.background ="#a8daff";
d142 16
d160 1
a160 1
if ( check_drop(active_row) == 0 ) {
d183 6
a188 4
posleft = event.clientX+document.body.scrollLeft;
postop = event.clientY+document.body.scrollTop;
if (imgID.style.visibility == "visible") moveimg();
return(false); }
d190 1
d192 13
a204 14
var selectobj = document.getElementById(Obj);
selectobj.length = 0;
var hlp = document.getElementById(Zone);
var num = (hlp.rows.length+(hlp.rows.length-1));
var pole = new Array(num);
pole = hlp.innerHTML.split("|");
for (var i=0; i < num; i++) {
if ( (i%2)==1)
 {
 hlp = new Option(pole[i],pole[i],false,false);
 selectobj.options[selectobj.options.length]= hlp;
 }
};
return(true);
d207 1
d209 5
a213 5
fill_select_by_zone("PageObj","drop_zone_page");
fill_select_by_zone("ColObj","drop_zone_collumn");
fill_select_by_zone("RowObj","drop_zone_row");
fill_select_by_zone("Metrics","drop_zone_metrics");
return(true);
@

