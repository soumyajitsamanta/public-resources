head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2003.11.18.14.38.40;	author jiri_schmid;	state Exp;
branches;
next	1.1;

1.1
date	2003.10.31.12.47.57;	author jiri_schmid;	state Exp;
branches;
next	;


desc
@@


1.2
log
@auto save when changing tabs implemented
@
text
@#-----------------------------------------------------
#  Grid Editation
#-----------------------------------------------------
# $Id: Graph3d_diam.pm,v 1.1 2003/10/31 12:47:57 jiri_schmid Exp $

package Graph3d_diam;

use strict;
require "local/Graph3d_lib.pm";

#-----------------------------------------------------
sub generateContent() {
my($variables, $lang, $obj) = (shift, shift, shift);
my $saved = $$variables->{saved} if exists $$variables->{saved};
my $localTab = $$variables->{localTab};
my ($fill, $itemsType);
print "<br><table class='page_skeleton'><tr class='page_skeleton'><td class='page_skeleton_ex' align='center'>";
if (&Graph3d_lib::existsDefinition($obj,$localTab)) {
if (@@{$$obj->{$localTab}{items}} == 0) {
	print "<span style='padding: 15px; line-height: 30px'>$$lang->{'Report Qualitative'}</span>";
} else {
my ($disable, $constant, $selected, $print, $check);
if ($$obj->{$localTab}{quantity} eq "off") {
$disable = "disabled='disabled'";
$constant = 1;
} else {
$print = 1;
$check = "onchange='checkNum(this)'";
}
print <<END;
	<table style='text-align:left; width:100%'>
	<tr>	<th style='white-space:nowrap'>$$lang->{'Graph3d default'}</td>
		<td><input onchange='checkNum(this)' type='text' name='default' size='15' value="$$obj->{$localTab}{default}"/></td>
		<td style='width:100%'>&nbsp;%</td>
	</tr>
	<tr>	<th style='white-space:nowrap'>$$lang->{'Graph3d interpolation'}</td>
		<td><select size='1' name='interpolation' style='width:100%' $disable>

END
	foreach ('constant','linear') {
		my $name = "Graph3d $_";
		my $selected = ($constant) ? ($_ eq 'constant') ? " selected='selected'" : "" : ($$obj->{$localTab}{interpolation} eq $_) ? " selected='selected'" : "";
		print "<option value='$_'$selected>$$lang->{$name}</option>";
	}
	print "</select></td><td>&nbsp</td></tr>";
	if ($print) {
		print "<tr><th style='white-space:nowrap'>$$lang->{'Min'}</th><td><input $check type='text' name='min' id='inputmin' style='width:100%' value='$$obj->{$localTab}{min}'/></td><td>&nbsp;</td></tr>";
		print "<tr><th style='white-space:nowrap'>$$lang->{'Max'}</th><td><input $check type='text' name='max' id='inputmax' style='width:100%' value='$$obj->{$localTab}{max}'/></td><td>&nbsp;</td></tr>";
	}
	my @@ids;
	print "<tr><td colspan='3'><hr/></td></tr>";
	my $name = "Graph3d Item$localTab";
	print "<tr><th style='text-align:left' colspan='2'>$$lang->{$name}</th><td style='text-align:right'><img class='cursor' src='$$variables->{skinPath}img/delete.$$variables->{imgType}' title=\"$$lang->{'Delete Active'}\" onclick='emptyBin()'></td></tr></table>";	
	print "<table style='text-align:left; width:100%''>";
	if (SOAP->GetObjectType(${$$obj->{$localTab}{items}}[$#{$$obj->{$localTab}{items}}]) =~ /metric/) {
		$itemsType = "<input type='hidden' value='1' name='metric'>";
		foreach (0..$#{$$obj->{$localTab}{items}}) {
		print "<tr><td colspan='3'><hr/></td></tr>";
			my $id = @@{$$obj->{$localTab}{items}}[$_];
			my $end = sprintf("%.0f",8/@@{$$obj->{$localTab}{items}});
			my $rowspan = $end+2;
			print "<tr><td style='text-align:center' rowspan='$rowspan'><span id='$id'>$id</span>:</td><td style='text-align:center'>$$lang->{'Graph3d Interval'}</td><td style='text-align:center'>$$lang->{'Graph3d Size'}</td></tr>";
				for my $cnt (0..$end) {
				my $index1 = $cnt * 2;
				my $index2 = $cnt * 2 + 1;
				print "<tr><td><input type='text' style='width:100%' name='view${_}$cnt' value='$$obj->{$localTab}{rules}[$_][$index1]' onfocus='setBin(this)'/></td><td><input type='text' style='width:100%' value='$$obj->{$localTab}{rules}[$_][$index2]' name='change${_}$cnt' onfocus='setBin(this)'></td></tr>";
				}
			push(@@ids,$id);
		}
	} else {
		print "<tr>";
		foreach (0..$#{$$obj->{$localTab}{items}}) {
			my $id = @@{$$obj->{$localTab}{items}}[$_];
			push(@@ids,$id);
			print "<td style='text-align:center'><span class='cursor' title=\"$$lang->{'Elements show'}\" id='$id' onclick='loadElement(this)'>$id</span>:</td>"; 
		}
		print "<td style='text-align:center'>$$lang->{'Graph3d Size'}(%)</td></tr>";
		my $plusOne = @@{$$obj->{$localTab}{items}};
		for my $cnt (0..5) {
			print "<tr>";
			foreach (0..$#{$$obj->{$localTab}{items}}) {
				print "<td><input type='text' style='width:100%' name='view${cnt}_${_}' value=\"$$obj->{$localTab}{rules}[$cnt][$_]\" onfocus='setBin(this)' onclick='addValue(this)'/></td>"; 
				}
			print "<td><input type='text' style='width:100%' value='$$obj->{$localTab}{rules}[$cnt][$plusOne]' name='change${cnt}' onfocus='setBin(this)'></td>";
			print "</tr>";
		}
	}
	print "</tr></table>";
	print "<input type='hidden' id='ids' value='".join("|",@@ids)."'/>";
	$fill = "fillAxis(true);";
print <<END;
	</td>
	</tr>	
	<tr class="page_skeleton">
	<td class="page_skeleton">
		<table class="neutral_100">
		<tr><td align="center">
			<table class="buttons" cellpading="0" cellspacing="0">
			<tr>	<td class="buttons"><input id='SAVE' type="submit" name="Action" value="$$lang->{'Save'}" /></td>
				<td class="buttons">
						<input type="submit" name="Action" value="$$lang->{'Save As'}" onclick="return readName();"/>
						<input type="hidden" name="saveAsName" id="saveAsName" value="" />
				</td>
				<td class="buttons"><input type="reset" name="reset" value="$$lang->{'Reset'}" /></td>
			</tr>
			</table>
		</td></tr>
		</table>
	</td></tr>
END
}
}
print <<END;
</td></tr>
</table>
	$itemsType
<script type="text/javascript" src="js/graph3d.js"></script>	
<script type="text/javascript">
	var msg="$$lang->{'New Save Part1'}$$lang->{'New Graph3d Save'}$$lang->{'New Save Part2'}";
	var saveAsMsg = "$$lang->{SaveAsMsg}$$lang->{'New Graph3d'}";
	reloadTree($saved);
	$fill
</script>
END
}

#---------------------------------------------------

sub set_next_param {
my ($o,$q,$localTab) = (shift,shift,shift);
&Graph3d_lib::saveDTSC($q,$o,$localTab);
}

1
@


1.1
log
@mod perl rocks!
@
text
@d4 1
a4 1
# $Id: graph3d_diam_ed.pl,v 1.18 2003/10/17 11:36:16 jiri_schmid Exp $
d99 1
a99 1
			<tr>	<td class="buttons"><input type="submit" name="Action" value="$$lang->{'Save'}" /></td>
@

