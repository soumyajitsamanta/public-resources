head	1.5;
access;
symbols;
locks; strict;
comment	@# @;


1.5
date	2004.04.16.16.43.07;	author vacula;	state Exp;
branches;
next	1.4;

1.4
date	2004.01.20.13.06.08;	author jiri_schmid;	state Exp;
branches;
next	1.3;

1.3
date	2003.12.04.12.15.33;	author jiri_schmid;	state Exp;
branches;
next	1.2;

1.2
date	2003.11.18.14.38.40;	author jiri_schmid;	state Exp;
branches;
next	1.1;

1.1
date	2003.10.31.12.47.57;	author jiri_schmid;	state Exp;
branches;
next	;


desc
@@


1.5
log
@changes for new interface
@
text
@#-----------------------------------------------------
#  Report Editation
#-----------------------------------------------------
# $Id: Report.pm,v 1.4 2004/01/20 13:06:08 jiri_schmid Exp $

package Report;

use strict;

#-----------------------------------------------------

sub generateContent {
my($variables, $lang, $obj, $q) = (shift, shift, shift, shift);

my $saved = $$variables->{saved} if exists $$variables->{saved};
my $saveRun = $$variables->{saveRun} if exists $$variables->{saveRun};
my $imgType = \$$variables->{imgType};
my $skinPath = \$$variables->{skinPath};
my $itemWidth = $Const::wb_const->{ $$variables->{wb} }{itemWidth};
print <<END;
<br />
<table class="page_skeleton">
<tr class="page_skeleton">
<td class="page_skeleton">
	<table class="neutral">
	<tr><td colspan="3" class="neutral_bold">$$lang->{'Report Filter'}</td></tr>
	<tr><td style='text-align:center'><img class="cursor" id="report_filter_link" onclick="newOrEdit('filter','report_filter_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/filter.$$imgType" /></td>
	    <td>
	    	<input onclick="drop_input(this)" id="report_filter" value="" type="text" size="$itemWidth" maxlength="100" readonly/>
		<input type="hidden" name="filter_id" id="report_filter_id" value="$$obj->{filter_def}"/>
	    </td>
	    <td><img class="cursor" src="${$skinPath}img/delete.$$imgType" title="$$lang->{Delete}" onclick="clearItem('report_filter')"></td>
	</tr>
	<tr><td colspan="3"><hr></td></tr>
	<tr><td colspan="3" class="neutral_bold">$$lang->{'Report Grid'}</td></tr>
	<tr><td style='text-align:center'>
		<img class="cursor" id="report_grid_link" onclick="newOrEdit('object','report_grid_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/grid.$$imgType" />
		<img class="cursor" id="report_grid_link" onclick="newOrEdit('object','report_grid_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/graph3d.$$imgType" />
	    </td>
	    <td>
	    	<input onclick="drop_input(this)" id="report_grid" value="" type="text" size="$itemWidth" maxlength="100" readonly/>
		<input type="hidden" name="object_id" id="report_grid_id" value="$$obj->{var_def}"/>
		<input type="hidden" name="report_type" id="report_type" value="$$obj->{report_type}"/>
	    </td>
	    <td><img class="cursor" src="${$skinPath}img/delete.$$imgType" title="$$lang->{Delete}" onclick="clearItem('report_grid')"></td>
	</tr>
	<tr><td colspan="3"><hr></td></tr>   
	<tr><td colspan="3" class="neutral_bold">$$lang->{'Report Format'}</td>
	</tr>
	<tr><td>
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/format.$$imgType" />
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/format2d.$$imgType" />
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/format2d_map.$$imgType" />
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/format3d.$$imgType" />
	    </td>
	    <td><input onclick="drop_input(this)" type="text" id="report_format" value="" size=$itemWidth" maxlength="100" readonly/>
	    <input type="hidden" name="format_id" id="report_format_id" value="$$obj->{format_def}"/>
	    </td>
	    <td><img class="cursor" src="${$skinPath}img/delete.$$imgType" title="$$lang->{Delete}" onclick="clearItem('report_format')"></td>
	</tr>
	<tr><td></td></tr>
	</table>
</td>
<tr class="page_skeleton">
<td class="page_skeleton">
	<table class='neutral_100'>
	<tr><td align='center'>
		<table class="buttons" style='padding:2px'>
		<tr>
		<td class="buttons"><input id='SAVE' type="submit" style='width:100%' name="Action" value="$$lang->{'Save'}" /></td>
		<td class="buttons"><input type="submit" style='width:100%' name="Action" value="$$lang->{'Save and Run'}" /></td>
		<td class="buttons">	<input type="submit" style='width:100%' name="Action" value="$$lang->{'Save As'}" onclick="return readName();"/>
					<input type="hidden" name="saveAsName" id="saveAsName" value="" /></td>
		<td class="buttons"><input type="button" style='width:100%' name="reset" value="$$lang->{'Reset'}" onclick="subst_ID('report_filter','report_grid','report_format')" /></td>
		</tr>
		<td class='buttons' colspan='2'><input type="button" style='width:100%' value="$$lang->{'Report Run'}" onclick="run_result()"/></td>
		<td class='buttons' colspan='2'>
				<select name="report_open_in" id="report_open_in" style='width:100%'>
END
my @@open_result = ('_default','_blank','_one','_collect');	#set values for open_in parameter used in user preferences
my $hlp = "";					#clear from previus text content
my $open = $q->param('report_open_in');
if ($$variables->{hidden}{'open_in'} eq '_self') {
	pop @@open_result;
	push @@open_result,'_self';
}
my $selected;
foreach (@@open_result) {
 $selected = ($_ eq $open) ? " selected='selected'" : "";
 $hlp .= "<option value=\"$_\"$selected>".$$lang->{"Prefer OpenR $_"}."</option>";
}
print $hlp;
print <<END;
				</select>
		</td></tr>
		</table>
	</td></tr>
</td></tr>
</table>
<input type="hidden" value="$$obj->{filter_def}|$$obj->{var_def}|$$obj->{format_def}" id="ITEMS"/>
<script type="text/javascript">
	var localItem = "$$lang->{'Report Local'}";
 	subst_ID('report_filter','report_grid','report_format');
	$saveRun
	var saveAsMsg = "$$lang->{SaveAsMsg}$$lang->{'New Report'}";
	reloadTree($saved);
	var msg="$$lang->{'New Save Part1'}$$lang->{'New Report Save'}$$lang->{'New Save Part2'}";
</script>
END
}

#---------------------------------------------------

sub set_next_param {
	my ($o,$q) = (shift,shift);
	$$o->{report_type} = $$q->param('report_type');
	$$o->{var_def} = $$q->param('object_id') if (not(ref($$o->{var_def}) =~ /HASH/ && $$q->param('object_id') =~ /HASH/));
	$$o->{filter_def} = $$q->param('filter_id') if (not(ref($$o->{filter_def}) =~ /HASH/ && $$q->param('filter_id') =~ /HASH/));
	$$o->{format_def} = $$q->param('format_id') if (not(ref($$o->{format_def}) =~ /HASH/ && $$q->param('format_id') =~ /HASH/));
}

1
@


1.4
log
@collected reports tab implementation started
@
text
@d4 1
a4 1
# $Id: Report.pm,v 1.3 2003/12/04 12:15:33 jiri_schmid Exp $
d53 1
@


1.3
log
@img type changes tested and fixed
@
text
@d4 1
a4 1
# $Id: Report.pm,v 1.2 2003/11/18 14:38:40 jiri_schmid Exp $
d79 1
a79 1
my @@open_result = ('_default','_blank','_one','_self');	#set values for open_in parameter used in user preferences
d82 4
@


1.2
log
@auto save when changing tabs implemented
@
text
@d4 1
a4 1
# $Id: Report.pm,v 1.1 2003/10/31 12:47:57 jiri_schmid Exp $
a96 1
<!--
a102 2

-->
@


1.1
log
@mod perl rocks!
@
text
@d4 1
a4 1
# $Id: report_def_ed.pl,v 1.7 2003/10/16 15:29:17 jiri_schmid Exp $
d69 1
a69 1
		<td class="buttons"><input type="submit" style='width:100%' name="Action" value="$$lang->{'Save'}" /></td>
@

