head	1.2;
access;
symbols;
locks; strict;
comment	@# @;


1.2
date	2003.11.18.14.38.40;	author jiri_schmid;	state Exp;
branches;
next	1.1;

1.1
date	2003.10.31.12.47.57;	author jiri_schmid;	state Exp;
branches;
next	;


desc
@@


1.2
log
@auto save when changing tabs implemented
@
text
@#-----------------------------------------------------
#  Report Editation
#-----------------------------------------------------
# $Id: Report_filter.pm,v 1.1 2003/10/31 12:47:57 jiri_schmid Exp $

package Report_filter;

use strict;
require "local/Generate.pm";

#-----------------------------------------------------

sub generateContent {
my($variables, $lang, $obj, $fullobj) = (shift, shift, shift, shift);

my $saved = $$variables->{saved} if exists $$variables->{saved};
my $saveRun = $$variables->{saveRun} if exists $$variables->{saveRun};
my $copy = $$variables->{contentVars} if exists $$variables->{contentVars};

if ($copy) {
my $hlp;
if ($copy eq '1') {
	&Local::loadMetadata($$obj->{filter_def},$fullobj,$obj);
	$hlp->{filter_def} = $$obj;
} else {
	$hlp->{filter_def}->{expr} = "";
};
$$obj = $hlp;
};


if (ref($$obj->{filter_def})) {

print <<END ;
<script src='js/report.js' type='text/javascript'></script>
<script src="js/filter_metric.js" type="text/javascript"></script>
<br />
<table class="page_skeleton">
<tr class="page_skeleton">
<td class="page_skeleton">

END

&Generate::generateFilterEdit($lang,$$variables->{skinPath},$$variables->{imgType},$obj,$Const::wb_const->{ $$variables->{wb}}{descriptionWidth},$Const::descriptionRows);

print <<END ;
</td></tr>
<tr class="page_skeleton">
<td class="page_skeleton">
	<table class="neutral_100">
	<tr><td align="right">
		<table class="buttons" cellpading="0" cellspacing="0">
		<tr>	<td class="buttons"><input id='SAVE' type="submit" name="Action" value="$$lang->{'Save'}" onclick="return filter_checker()"/></td>
			<td class="buttons"><input type="submit" name="Action" value="$$lang->{'Save and Run'}" onclick="return filter_checker()" /></td>
			<td class="buttons">	<input type="submit" name="Action" value="$$lang->{'Save As Filter'}" onclick="readName(); return filter_checker()"/>
						<input type="hidden" name="saveAsName" id="saveAsName" value="" /></td>
			<td class="buttons"><input type="button" name="reset" value="$$lang->{'Reset'}" onclick="subst_ID_expr('object_filter');"/></td>
		</tr>
		</table>
	</td></tr>
	</table>
</td></tr>
</table>
<script type="text/javascript">
<!--
	var saveAsMsg = "$$lang->{SaveAsMsg}$$lang->{'New Filter'}";
	var msg="$$lang->{'New Save Part1'}$$lang->{'New Filter Save'}$$lang->{'New Save Part2'}";
	subst_ID_expr('object_filter');
	$saveRun
	reloadTree($saved);
-->
</script>
END
} else {
print "<p><b>&nbsp;$$lang->{'Report Lfilter'}</b>$$lang->{'Report No Filter'}<ul>";
if ($$obj->{filter_def}) {
	print "<li><a href=\"javascript: editOriginal('$$obj->{filter_def}','Fi');\">$$lang->{'Report Global Edit'}</a></li>";
	print "<li><a href=\"javascript: editLocal('filter','1');\">$$lang->{'Report Local Edit'}</a></li>";
};
print "<li><a href=\"javascript: editLocal('filter');\">$$lang->{'Report New Local'}</a></li></ul></p>";
print "<script type='text/javascript'>reloadTree($saved)</script>";
}}

#---------------------------------------------------
sub set_next_param {
my ($o,$q) = (shift,shift);
my $hlp;
$hlp->{orig_id} = (ref($$o->{filter_def})) ? $$o->{filter_def}->{orig_id} : $$o->{filter_def};
$hlp->{'expr'} = $$q->param('expr_id');
$$o->{filter_def} = $hlp;
}

1
@


1.1
log
@mod perl rocks!
@
text
@d4 1
a4 1
# $Id: report_filter_ed.pl,v 1.8 2003/10/16 14:08:53 jiri_schmid Exp $
d53 1
a53 1
		<tr>	<td class="buttons"><input type="submit" name="Action" value="$$lang->{'Save'}" onclick="return filter_checker()"/></td>
@

