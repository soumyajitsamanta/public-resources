head	1.51;
access;
symbols;
locks; strict;
comment	@# @;


1.51
date	2003.10.16.14.08.53;	author jiri_schmid;	state dead;
branches;
next	1.50;

1.50
date	2003.09.22.11.52.39;	author jiri_schmid;	state Exp;
branches;
next	1.49;

1.49
date	2003.09.18.14.07.41;	author jiri_schmid;	state Exp;
branches;
next	1.48;

1.48
date	2003.09.01.12.40.08;	author jiri_schmid;	state Exp;
branches;
next	1.47;

1.47
date	2003.08.28.09.26.16;	author jiri_schmid;	state Exp;
branches;
next	1.46;

1.46
date	2003.08.26.15.35.45;	author jiri_schmid;	state Exp;
branches;
next	1.45;

1.45
date	2003.08.20.14.23.45;	author jiri_schmid;	state Exp;
branches;
next	1.44;

1.44
date	2003.08.13.14.22.03;	author jiri_schmid;	state Exp;
branches;
next	1.43;

1.43
date	2003.08.13.13.16.28;	author jiri_schmid;	state Exp;
branches;
next	1.42;

1.42
date	2003.08.05.13.03.00;	author jiri_schmid;	state Exp;
branches;
next	1.41;

1.41
date	2003.07.29.14.36.42;	author jiri_schmid;	state Exp;
branches;
next	1.40;

1.40
date	2003.07.24.12.14.58;	author jiri_schmid;	state Exp;
branches;
next	1.39;

1.39
date	2003.07.18.10.51.01;	author jiri_schmid;	state Exp;
branches;
next	1.38;

1.38
date	2003.07.10.13.00.04;	author jiri_schmid;	state Exp;
branches;
next	1.37;

1.37
date	2003.07.04.14.29.33;	author jiri_schmid;	state Exp;
branches;
next	1.36;

1.36
date	2003.06.19.14.59.45;	author jiri_schmid;	state Exp;
branches;
next	1.35;

1.35
date	2003.06.17.08.45.49;	author jiri_schmid;	state Exp;
branches;
next	1.34;

1.34
date	2003.06.03.08.16.08;	author jiri_schmid;	state Exp;
branches;
next	1.33;

1.33
date	2003.05.27.14.12.13;	author jiri_schmid;	state Exp;
branches;
next	1.32;

1.32
date	2003.05.26.15.01.41;	author jiri_schmid;	state Exp;
branches;
next	1.31;

1.31
date	2003.05.19.14.32.31;	author jiri_schmid;	state Exp;
branches;
next	1.30;

1.30
date	2003.05.16.12.58.11;	author jiri_schmid;	state Exp;
branches;
next	1.29;

1.29
date	2003.05.14.15.36.46;	author jiri_schmid;	state Exp;
branches;
next	1.28;

1.28
date	2003.05.13.15.19.00;	author jiri_schmid;	state Exp;
branches;
next	1.27;

1.27
date	2003.05.06.15.07.07;	author jiri_schmid;	state Exp;
branches;
next	1.26;

1.26
date	2003.04.16.11.18.13;	author jiri_schmid;	state Exp;
branches;
next	1.25;

1.25
date	2003.04.14.15.12.04;	author jiri_schmid;	state Exp;
branches;
next	1.24;

1.24
date	2003.04.14.12.56.38;	author jiri_schmid;	state Exp;
branches;
next	1.23;

1.23
date	2003.04.14.11.06.07;	author jiri_schmid;	state Exp;
branches;
next	1.22;

1.22
date	2003.04.10.14.19.17;	author jiri_schmid;	state Exp;
branches;
next	1.21;

1.21
date	2003.03.26.14.52.28;	author jiri_schmid;	state Exp;
branches;
next	1.20;

1.20
date	2003.03.26.13.54.25;	author jiri_schmid;	state Exp;
branches;
next	1.19;

1.19
date	2003.03.14.09.23.52;	author jiri_schmid;	state Exp;
branches;
next	1.18;

1.18
date	2003.03.10.16.14.13;	author jiri_schmid;	state Exp;
branches;
next	1.17;

1.17
date	2003.03.03.13.30.26;	author spanhel;	state Exp;
branches;
next	1.16;

1.16
date	2003.02.28.13.43.18;	author jiri_schmid;	state Exp;
branches;
next	1.15;

1.15
date	2003.02.28.10.43.39;	author jiri_schmid;	state Exp;
branches;
next	1.14;

1.14
date	2003.02.26.13.21.49;	author jiri_schmid;	state Exp;
branches;
next	1.13;

1.13
date	2003.02.25.09.18.10;	author jiri_schmid;	state Exp;
branches;
next	1.12;

1.12
date	2003.02.24.15.31.22;	author jiri_schmid;	state Exp;
branches;
next	1.11;

1.11
date	2003.02.21.09.29.06;	author jiri_schmid;	state Exp;
branches;
next	1.10;

1.10
date	2003.02.20.14.45.00;	author jiri_schmid;	state Exp;
branches;
next	1.9;

1.9
date	2003.02.14.09.13.00;	author jiri_schmid;	state Exp;
branches;
next	1.8;

1.8
date	2003.02.12.15.01.57;	author jiri_schmid;	state Exp;
branches;
next	1.7;

1.7
date	2003.02.11.16.07.13;	author jiri_schmid;	state Exp;
branches;
next	1.6;

1.6
date	2003.01.30.12.50.53;	author jiri_schmid;	state Exp;
branches;
next	1.5;

1.5
date	2003.01.16.17.20.20;	author spanhel;	state Exp;
branches;
next	1.4;

1.4
date	2002.11.26.12.44.38;	author spanhel;	state Exp;
branches;
next	1.3;

1.3
date	2002.11.22.12.54.11;	author spanhel;	state Exp;
branches;
next	1.2;

1.2
date	2002.11.01.11.49.40;	author spanhel;	state Exp;
branches;
next	1.1;

1.1
date	2002.10.25.14.03.25;	author spanhel;	state Exp;
branches;
next	;


desc
@@


1.51
log
@mod-perl implementation stage 1, rebuilding global vars in .pl to global pointers
@
text
@#-----------------------------------------------------
#  Format Editation
#-----------------------------------------------------
# $Id: format_ed.pl,v 1.50 2003/09/22 11:52:39 jiri_schmid Exp $

use strict;
use CGI qw( :standard );
use CGI::Pretty;

require "const.def";

use vars qw($ID $Obj $ObjT $use_lang $open $lang $all_params $localTab $skin $skinPath $imgType $DefaultLanguage);


#-----------------------------------------------------
# print_form is called from edit.cgi

sub print_form {
	print startform(-action=>'', -name=>'format', onsubmit=>'return reset_tree_name();');
	print hidden('ObjT',$ObjT);
	print hidden('skin',$skin);
	print hidden('local_tab',$localTab);
	print hidden('all_params',$all_params);
	my $name = LocalizedObj($Obj->{name}, "Object #$ID", lc($use_lang), $DefaultLanguage);
print <<END;
<input type="hidden" value="$use_lang" id="activeLang" name="active_lang" />
<input type="hidden" value="$skin" id="skin" name="skin" />
<input type="hidden" value="$imgType" id="imgType" />
<input type='hidden' name='item_id' id='ITEM_ID' value='$ID'/>
<input type="hidden" value="$Obj->{form}" name="form" id="form"/>\
<input type="hidden" value="grid" name="type" id="type"/>
<input type="hidden" value="$Obj->{header}" name="header" id="header"/>
<table><tr>
	<td style='width:20px'><img src="${skinPath}img/format.$imgType"></td>
	<td class="neutral_title">$lang->{'Format Edit'}</td>
	<td >- $name</td>
</tr></table>
END
&generateTabs($localTab,'Format','format','def','rights');
print "<table class='local_tabline' cellspacing='0'><tr><td>\n";
&generateContent();
print "</td></tr><tr><td>&nbsp;</td></tr></table>";
print "<script type='text/javascript'>var params = '$all_params';</script>";
print &endform;
}

1
@


1.50
log
@format page - visual improvment
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.49 2003/09/18 14:07:41 jiri_schmid Exp $
@


1.49
log
@tabs imlemented almost everywhere
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.48 2003/09/01 12:40:08 jiri_schmid Exp $
d30 3
@


1.48
log
@skins implemented. mozilla skin - temporarily copy msie content
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.47 2003/08/28 09:26:16 jiri_schmid Exp $
d12 1
a12 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w $lang $saved @@Languages $DefaultLanguage $use_lang $iframeHeight $all_params $skin $skinPath $imgType);
d19 1
a19 1
	print startform(-action=>'', -name=>'format3d', onsubmit=>'return reset_tree_name();');
d22 1
a23 1
	print "<input type=\"hidden\" value=\"$use_lang\" id=\"activeLang\" name=\"active_lang\">\n";
d26 4
a34 14
<br />
<table class="page_skeleton">
<tr class="page_skeleton">
<td class="page_skeleton">
	<IFRAME class="formatIframe" name='format' src="format.cgi?Lang=$use_lang&Skin=$skin&Type=grid&Form=$Obj->{form}&Header=$Obj->{header}" width="480px" height="$iframeHeight" scrolling="auto" frameborder="0"></IFRAME>
</td>
<td>&nbsp;</td>
<td class="page_skeleton">
	<table class="neutral">
	<tr><td class="neutral_bold">$lang->{'Name'}</td></tr>
	<tr><td align="center">
		<span class='nowrap'>
		<input value="" onchange="object_changed()" type="text" name="name" id="NAME" size="$name_w" maxlength="100"/>
		<select name="langSpec" id="langSpec" onchange="tmpChangeLocal()">
d36 6
a41 43
foreach (@@Languages) {
	my $lcL = lc($_);
	my $name = LocalizedObj($Obj->{name}, "Object #$ID", $lcL, $DefaultLanguage);
	print "<option value='$name'>$_</option>";
}
print <<END;
		</select>
		<input type="hidden" name="item_id" id="ITEM_ID" value="$ID"/>
		</span>
	</td></tr>
	<tr><td><hr></td></tr>
	<tr><td class="neutral_bold">$lang->{'Description'}</td></tr>
	<tr><td align="center"><textarea onchange="object_changed()" cols="$descr_w" rows="$descr_r" name="desc" id="DESC"></textarea></td></tr>
	<tr><td><hr></td></tr>
	<tr><td align="center">
	<table class="buttons" cellpading="0" cellspacing="0">
	<tr>	<td class="buttons"><input type="submit" name="Action" value="$lang->{'Save'}" onclick="check_name()"/></td>
			<td class="buttons">	<input type="submit" name="Action" value="$lang->{'Save As'}" onclick="return readName();"/>
						<input type="hidden" name="saveAsName" id="saveAsName" value="" /></td>
		<td class="buttons"><input type="button" name="reset" value="$lang->{'Reset'}" onclick="subst_item_id(); self.frames['format'].location.reload(true)"/></td>
		<td class="buttons"><input type="submit" name="Rights" value="$lang->{'Right'}" onclick='setRightsPage()' /></td>
	</tr>
	</table>
	</td></tr>
	</table>
</td></tr></table>
<input type="hidden" value="$Obj->{form}" name="form" id="form"/>\
<input type="hidden" value="grid" name="type" id="type"/>
<input type="hidden" value="$Obj->{header}" name="header" id="header"/>
<script type="text/javascript">
	subst_item_id();
	var saveAsMsg = "$lang->{SaveAsMsg}$lang->{'New Format'}";
	reloadTree($saved);
</script>
END
}

#---------------------------------------------------
sub set_next_param {
	my $o=shift;
	$o->{type} = param('type');
	$o->{form} = param('form');
	$o->{header} = param('header');
@


1.47
log
@tabs.cgi speed improvmnet, visual improvment on trees, rights and some other minor improvments
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.46 2003/08/26 15:35:45 jiri_schmid Exp $
d12 1
a12 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w $lang $saved @@Languages $DefaultLanguage $use_lang $iframeHeight);
d21 2
d27 1
a27 1
	<td style='width:20px'><img src="img/format.gif"></td>
d35 1
a35 1
	<IFRAME class="formatIframe" name='format' src="format.cgi?Lang=$use_lang&Type=grid&Form=$Obj->{form}&Header=$Obj->{header}" width="480px" height="$iframeHeight" scrolling="auto" frameborder="0"></IFRAME>
@


1.46
log
@rights improvment, create delete duplicate rule implemented
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.45 2003/08/20 14:23:45 jiri_schmid Exp $
d22 8
a29 4

print <<END ;
<table><tr><td width="20"><img src="img/format.gif"></td><td class="neutral_title">$lang->{'Format Edit'}</td></tr></table>
<br>
@


1.45
log
@access object implemented
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.44 2003/08/13 14:22:03 jiri_schmid Exp $
d60 1
a60 1
		<td class="buttons"><input type="submit" name="Rights" value="$lang->{'Right'}"/></td>
@


1.44
log
@code clearing and improvment
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.43 2003/08/13 13:16:28 jiri_schmid Exp $
d71 1
a71 1
	var saveAsMsg = "$lang->{SaveAsMsg}$lang->{'New Format3d'}";
@


1.43
log
@setting up rights inetrface for each object implemnted
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.42 2003/08/05 13:03:00 jiri_schmid Exp $
d19 2
a20 3
	my $cgi = shift;
	print $cgi->startform(-action=>'', -name=>'format3d', onsubmit=>'return reset_tree_name();');
	print $cgi->hidden('ObjT',$ObjT);
a78 1
	my($cgi) = shift;
@


1.42
log
@noWrap on name and language
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.41 2003/07/29 14:36:42 jiri_schmid Exp $
d61 2
a62 1
	</td></tr>
@


1.41
log
@code improvments
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.40 2003/07/24 12:14:58 jiri_schmid Exp $
d37 1
a37 1
		<span style="white-space:nowrap">
a39 1
		</span>
d49 1
@


1.40
log
@code change/improvment, bug fixies
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.39 2003/07/18 10:51:01 jiri_schmid Exp $
d12 1
a12 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w $lang $saved @@Languages $DefaultLanguage $use_lang);
d30 1
a30 1
	<IFRAME class="formatIframe" name='format' src="format.cgi?Lang=$use_lang&Type=grid&Form=$Obj->{form}&Header=$Obj->{header}" width="480px" height="100%" scrolling="auto" frameborder="0"></IFRAME>
@


1.39
log
@format3d implemented, format changed all dependencies fixed
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.38 2003/07/10 13:00:04 jiri_schmid Exp $
a68 1
<script type="text/javascript" src="js/format.js"></script>
@


1.38
log
@tabed graph3d implemnted, code improvment
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.37 2003/07/04 14:29:33 jiri_schmid Exp $
d12 1
a12 1
use vars qw($ID $ObjT $lang $all_params $localTab $use_lang);
d20 1
a20 1
	print $cgi->startform(-action=>'', -name=>'format', onsubmit=>'return reset_tree_name();');
a21 2
	print $cgi->hidden('all_params',$all_params);
	print $cgi->hidden('local_tab',$localTab);
d23 62
a84 9
print "<script src='js/format.js' type='text/javascript'></script>\n";
print "<input type='hidden' name='item_id' id='ITEM_ID' value='$ID'/>\n";
print "<table><tr><td width='20'><img src='img/format.gif'></td><td class='neutral_title'>&nbsp;$lang->{'Format Edit'}</td></tr></table>\n";
&generateTabs($localTab,'Format','format','def');
print "<table class='local_tabline' cellspacing='0'><tr><td>\n";
&generateContent();
print "</td></tr><tr><td>&nbsp;</td></tr></table>";
print "<script type='text/javascript'>var params = '$all_params';</script>";
print $cgi->endform;
@


1.37
log
@utf8 handling fixed
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.36 2003/06/19 14:59:45 jiri_schmid Exp $
d12 1
a12 1
use vars qw($ID $ObjT $lang $all_params $formatTab $use_lang);
d23 1
a23 1
	print $cgi->hidden('format_tab',$formatTab);
d27 5
a31 2
generateTabs($formatTab);

a33 21
}

#-----------------------------------------------------

sub generateTabs(){
my $formatTab = shift;
print "<table><tr><td width='20'><img src='img/format.gif'></td><td class='neutral_title'>&nbsp;$lang->{'Format Edit'}</td></tr></table>\n";
print "<table class='report_tabs' cellspacing='0' width='100%'><tr>\n";
my @@tabs = ('format','def');
my $lastTab = @@tabs[$#tabs];
my $hlp = "<td></td>";
foreach (@@tabs) {
	my $activeTab = ($formatTab eq $_) ? "active" : "tabs";
	my $viewName = "Format ".$_;
	$hlp = "" if ($_ eq $lastTab);
	print "<td class='$activeTab"."Corner'><img src='img/leftCorner.gif'/></td><td class='$activeTab' ><a href=\"javascript: viewLocalFormat('$_')\" >$lang->{$viewName}</a></td><td class='$activeTab"."Corner'><img src='img/rightCorner.gif'/></td>$hlp\n";
};
print "</tr></table><table class='report_tabline' cellspacing='0'><tr><td>\n";
generateContent();
print "</td></tr><tr><td>&nbsp;</td></tr></table>";

@


1.36
log
@huge improvment on format page
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.35 2003/06/17 08:45:49 jiri_schmid Exp $
d46 1
a46 1
	print "<td class='$activeTab"."Corner'><img src='img/leftCorner.gif'/></td><td class='$activeTab' ><a href=\"javascript: viewLocal('$_')\" >$lang->{$viewName}</a></td><td class='$activeTab"."Corner'><img src='img/rightCorner.gif'/></td>$hlp\n";
@


1.35
log
@changed structure of format object
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.34 2003/06/03 08:16:08 jiri_schmid Exp $
a10 1
require "local_lib.pl";
d12 1
a12 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w $use_lang $saved @@Languages $DefaultLanguage);
d20 11
a30 2
#	print_decl($cgi);
	print_form_cont($cgi);
d35 16
a50 59
sub print_form_cont {
	my $cgi = shift;
	print $cgi->startform(-action=>'', -name=>'format', onsubmit=>'return reset_tree_name();');
	print $cgi->hidden('ObjT',$ObjT);
	print "<input type=\"hidden\" value=\"$use_lang\" id=\"activeLang\" name=\"active_lang\">\n";
# display form
#	use Data::Dumper;
#        print "<PRE>A".Dumper($Obj)."</PRE>";
print <<END ;
<table><tr><td width="20"><img src="img/format.gif"></td><td class="neutral_title">$lang->{'Format Edit'}</td></tr></table>
<br>
<table class="page_skeleton">
<tr class="page_skeleton">
<td class="page_skeleton">
END
&generateFormatEdit();
print <<END ; 
</td>
<td class="page_skeleton">&nbsp;</td>
<td class="page_skeleton">
	<table class="neutral">
	<tr><td class="neutral_bold">$lang->{'Name'}</td></tr>
	<tr><td align="center">
		<input value="" onchange="object_changed()" type="text" name="name" id="NAME" size="$name_w" maxlength="100"/>
		<select name="langSpec" id="langSpec" onchange="tmpChangeLocal()">
END
foreach (@@Languages) {
	my $lcL = lc($_);
	my $name = LocalizedObj($Obj->{name}, "Object #$ID", $lcL, $DefaultLanguage);
	print "<option value='$name'>$_</option>";
}
print <<END;
		</select>
		<input type="hidden" name="item_id" id="ITEM_ID" value="$ID"/>
	</td></tr>
	<tr><td><hr></td></tr>
	<tr><td class="neutral_bold">$lang->{'Description'}</td></tr>
	<tr><td align="center"><textarea onchange="object_changed()" cols="$descr_w" rows="$descr_r" name="desc" id="DESC">$Obj->{description}</textarea></td></tr>
	<tr><td><hr></td></tr>
	<tr><td align="center">
	<table class="buttons" cellpading="0" cellspacing="0">
	<tr>	<td class="buttons"><input type="submit" name="Action" value="$lang->{'Save'}" onclick="check_name()"/></td>
			<td class="buttons">	<input type="submit" name="Action" value="$lang->{'Save As'}" onclick="return readName();"/>
						<input type="hidden" name="saveAsName" id="saveAsName" value="" /></td>
		<td class="buttons"><input type="button" name="reset" value="$lang->{'Reset'}" onclick="subst_item_id()"/></td>
	</td></tr>
	</table>
	</td></tr>
	</table>
</td></tr></table>
<script type="text/javascript">
	var msg="$lang->{'New Save Part1'}$lang->{'New Format Save'}$lang->{'New Save Part2'}";
	subst_item_id();
	var saveAsMsg = "$lang->{SaveAsMsg}$lang->{'New Format'}";
	reloadTree($saved);
</script>
END
	print $cgi->endform;
}
a51 6
#---------------------------------------------------
sub set_next_param {
	my($cgi) = shift;
	my $o=shift;
	$o->{type} = param('typ');
	$o->{form} = param('form');
a52 1

@


1.34
log
@code improvment
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.33 2003/05/27 14:12:13 jiri_schmid Exp $
d91 2
a92 7
	# !!! parametry ColObj, ... budou nahrazeny parametry nesoucimi ID objektu nastavovanym JavaScripten onUnload
	delete $o->{css};
	delete $o->{graph};
	my($form)=$cgi->param('form');
	if ($form eq 'css') {$o->{css}->{type} = $cgi->param('type_css')};
	if ($form eq 'graph') {$o->{graph}->{type}= $cgi->param('type_graph')};

@


1.33
log
@implemented setLocalizedObj & LocalizedObj on client side
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.32 2003/05/26 15:01:41 jiri_schmid Exp $
a52 1
my $choosed;
a53 1
	$choosed = ($_ eq $use_lang) ? ' selected' : '';
d56 1
a56 1
	print "<option value='$name' $choosed>$_</option>";
@


1.32
log
@saving under non-selected language implemented
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.31 2003/05/19 14:32:31 jiri_schmid Exp $
d13 1
a13 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w $use_lang $saved @@Languages);
d57 2
a58 1
	print "<option value='$Obj->{name}->{$lcL}' $choosed>$_</option>";
@


1.31
log
@save-as bug when canceling saving fixed
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.30 2003/05/16 12:58:11 jiri_schmid Exp $
d13 1
a13 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w $use_lang $saved);
d31 1
a31 1
	print $cgi->hidden('active_lang',$use_lang);
d50 11
a60 1
		<input value="$Obj->{name}" onchange="object_changed()" type="text" name="name" id="NAME" size="$name_w" maxlength="100"/>
@


1.30
log
@save as implemented everywhere
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.29 2003/05/14 15:36:46 jiri_schmid Exp $
d60 1
a60 1
			<td class="buttons">	<input type="submit" name="Action" value="$lang->{'Save As'}" onclick="readName()"/>
@


1.29
log
@minor code improvments
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.28 2003/05/13 15:19:00 jiri_schmid Exp $
d13 1
a13 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w $use_lang);
d60 2
d71 2
@


1.28
log
@new report page seems to be fullfunctional, javascript code huge improvment
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.27 2003/05/06 15:07:07 jiri_schmid Exp $
d59 1
a59 1
	<tr>	<td class="buttons"><input type="submit" name="Action" value="$lang->{'Save'}" onclick="check_name(\'#$ID\')"/></td>
@


1.27
log
@bug fixies, code improvment
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.26 2003/04/16 11:18:13 jiri_schmid Exp $
a34 12
my $Form = (exists($Obj->{'graph'})) ? "graph" : "css";
my $checked_graph = "";
my $checked_css = ""; 
my $Type = "";
if ($Form eq "graph") 
	{$Type = $Obj->{graph}->{type};
	 $checked_graph = "checked=\"true\"";}
else
	{$Type = $Obj->{css}->{type};
	$checked_css = "checked=\"true\"";}


d41 3
a43 13
	<table class="neutral">
	<tr>	<td>	<input type="radio" id="in_css" name="style" value="CSS" $checked_css onclick="change_style('format.cgi?Lang=$use_lang&Form=css&Type=$Obj->{css}->{type}');return true;"/>
			<span class="cursor" onclick="document.getElementById('in_css').onclick()">$lang->{'Format radio_btn css'}</span>
			<input type="radio" id="in_graph" name="style" value="Graph" $checked_graph onclick="change_style('format.cgi?Lang=$use_lang&Form=graph&Type=$Obj->{graph}->{type}');return true;"/>
			<span class="cursor" onclick="document.getElementById('in_graph').onclick()">$lang->{'Format radio_btn graph'}</span>
			<input id="forma" value="" type="hidden" name="form"/>
			<input id="typ_css" value="$Obj->{css}->{type}" type="hidden" name="type_css"/>
			<input id="typ_graph" value="$Obj->{graph}->{type}" type="hidden" name="type_graph"/>
			</td>
	</tr>
	<tr>	<td align="center"><IFRAME id="css_graph" src="format.cgi?Lang=$use_lang&Form=$Form&Type=$Type" width="275" height="375" scrolling="auto" frameborder="0"></IFRAME>         	      
	</tr>
	</table>
d66 1
a66 1
<script language="JAVASCRIPT" type="text/javascript">
@


1.26
log
@id substitution implemented in all of *_ed.pl
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.25 2003/04/14 15:12:04 jiri_schmid Exp $
d29 1
a29 1
	print $cgi->startform(-action=>'', -name=>'format', onsubmit=>'reset_tree_name();return true;');
@


1.25
log
@minor changes in naming of new objects
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.24 2003/04/14 12:56:38 jiri_schmid Exp $
d81 1
a81 1
	<tr>	<td class="buttons"><input type="submit" name="Action" value="$lang->{'Save'}" onclick="check_name(\'$lang->{'New Format'} #$ID\')"/></td>
@


1.24
log
@ID <-> name substitutions implemented on client side in required cases
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.23 2003/04/14 11:06:07 jiri_schmid Exp $
d81 3
a83 3
	<tr>	<td class="buttons"><input type="submit" name="Action" value="$lang->{'Save'}" onclick="check_name(\'$lang->{'New Format'}\')"/></td>
		<td class="buttons"><input type="reset" name="reset" value="$lang->{'Reset'}"/></td>
		<td class="buttons"><input type="button" name="reload" value="$lang->{'Reload'}" onclick='reload_btn();return true;'/></td></tr>
@


1.23
log
@new item localization implemented, prompt for changing name when saving under server side generated name
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.22 2003/04/10 14:19:17 jiri_schmid Exp $
a30 1
	print $cgi->hidden('item_id',$ID);
d54 1
a54 1
	<tr>	<td>	<input type="radio" id="in_css" name="style" value="CSS" $checked_css onclick="change_style('format.cgi?Lang=$use_lang&Form=css&Type=$Obj->{css}->{type}');return true;">
d56 1
a56 1
			<input type="radio" id="in_graph" name="style" value="Graph" $checked_graph onclick="change_style('format.cgi?Lang=$use_lang&Form=graph&Type=$Obj->{graph}->{type}');return true;">
d71 4
a74 1
	<tr><td align="center"><input value="$Obj->{name}" onchange="object_changed()" type="text" name="name" id="NAME" size="$name_w" maxlength="100"></td></tr>
d81 3
a83 3
	<tr>	<td class="buttons"><input type="submit" name="Action" value="$lang->{'Save'}" onclick="check_name(\'$lang->{'New Format'}\')"></td>
		<td class="buttons"><input type="reset" name="reset" value="$lang->{'Reset'}"></td>
		<td class="buttons"><input type="button" name="reload" value="$lang->{'Reload'}" onclick='reload_btn();return true;'></td></tr>
d90 1
@


1.22
log
@metric, filter, report substitutes IDs by javascript, metric & filter resets the original expresion
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.21 2003/03/26 14:52:28 jiri_schmid Exp $
d79 1
a79 1
	<tr>	<td class="buttons"><input type="submit" name="Action" value="$lang->{'Save'}"></td>
d86 3
a88 1

@


1.21
log
@IE visual bugs on format page fixed
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.20 2003/03/26 13:54:25 jiri_schmid Exp $
d72 1
a72 1
	<tr><td align="center"><input value="$Obj->{name}" onchange="object_changed()" type="text" name="name" size="$name_w" maxlength="100"></td></tr>
d75 1
a75 1
	<tr><td align="center"><textarea onchange="object_changed()" cols="$descr_w" rows="$descr_r" name="desc">$Obj->{description}</textarea></td></tr>
@


1.20
log
@total remake of format, files formatXXX.html repalced by format.cgi because of languge mutations
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.19 2003/03/14 09:23:52 jiri_schmid Exp $
d64 1
a64 1
	<tr>	<td align="center"><IFRAME id="css_graph" src="format.cgi?Lang=$use_lang&Form=$Form&Type=$Type" width="100%" height="375" scrolling="auto" frameborder="0"></IFRAME>         	      
@


1.19
log
@solved problem with CZ chars, by forced 8bit operating XML-UTF8 files, removed unused images
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.18 2003/03/10 16:14:13 jiri_schmid Exp $
a26 6
sub print_decl {

} 

#-----------------------------------------------------

d36 11
d48 1
a48 1
	print <<END ;
d55 4
a58 4
	<tr>	<td>	<input type="radio" id="in_css" name="style" value="CSS" checked="true" onclick="change_style('format_css.html');return true;">
			<span class="cursor" onclick="change_style('format_css.html');return true;">$lang->{'Format radio_btn css'}</span>
			<input type="radio" id="in_graph" name="style" value="Graph" onclick="change_style('format_graph.html');return true;">
			<span class="cursor" onclick="change_style('format_graph.html');return true;">$lang->{'Format radio_btn graph'}</span>
d64 1
a64 1
	<tr>	<td align="center"><IFRAME id="css_graph" src="format.html" width="100%" height="375" scrolling="auto" frameborder="0"></IFRAME>         	      
@


1.18
log
@charset fixed
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.17 2003/03/03 13:30:26 spanhel Exp $
d44 1
a44 1
<table><tr><td width="20"><img src="img/format_new.gif"></td><td class="neutral_title">$lang->{'Format Edit'}</td></tr></table>
@


1.17
log
@lang version
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.16 2003/02/28 13:43:18 jiri_schmid Exp $
d13 1
a13 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w);
d38 1
@


1.16
log
@weekend-leaving commit, (last?) code cleaning
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.15 2003/02/28 10:43:39 jiri_schmid Exp $
d13 1
a13 1
use vars qw($ID $Obj $ObjT $al $descr_w $descr_r $name_w);
d43 1
a43 1
<table><tr><td width="20"><img src="img/format_new.gif"></td><td class="neutral_title">$al->{'Format Edit'}</td></tr></table>
d50 1
a50 1
			<span class="cursor" onclick="change_style('format_css.html');return true;">$al->{'Format radio_btn css'}</span>
d52 1
a52 1
			<span class="cursor" onclick="change_style('format_graph.html');return true;">$al->{'Format radio_btn graph'}</span>
d65 1
a65 1
	<tr><td class="neutral_bold">$al->{'Name'}</td></tr>
d68 1
a68 1
	<tr><td class="neutral_bold">$al->{'Description'}</td></tr>
d73 3
a75 3
	<tr>	<td class="buttons"><input type="submit" name="Action" value="$al->{'Save'}"></td>
		<td class="buttons"><input type="reset" name="reset" value="$al->{'Reset'}"></td>
		<td class="buttons"><input type="button" name="reload" value="$al->{'Reload'}" onclick='reload_btn();return true;'></td></tr>
@


1.15
log
@added files admin,prefer.cgi, unused content of *.css removed with minor visual changes
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.14 2003/02/26 13:21:49 jiri_schmid Exp $
d65 5
a69 2
	<tr><td class="neutral_bold">$al->{'Format name'}</td></tr>
	<tr><td align="center"><input value="$Obj->{name}"  onchange="object_changed()" type="text" name="name" size="$name_w" maxlength="100"/></td></tr>
a70 2
	<tr><td class="neutral_bold">$al->{'Format description'}</td></tr>
	<tr><td><textarea onchange="object_changed()" cols="$descr_w" rows="$descr_r" name="desc">$Obj->{description}</textarea></td></tr>
d78 2
a79 3
</td></tr>
</table>			     

@


1.14
log
@huge javascript optimalization, also files moved to directory js
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.13 2003/02/25 09:18:10 jiri_schmid Exp $
d43 1
a43 1
<table><tr><td width="20"><img src="img/format_new.gif"></td><td class="neutral_bold">$al->{'Format Edit'}</td></tr></table>
@


1.13
log
@added checking of unsaved-changed item, when traying to start editing another one
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.12 2003/02/24 15:31:22 jiri_schmid Exp $
a34 2
	
#	print $cgi->startform(-action=>'', -name=>'grid', -onSubmit=>'setAll(setAll(document.PromptForm.MetricsUse); resetAll(document.PromptForm.Metrics; document.PromptForm.RowObj); setAll(document.PromptForm.ColObj); setAll(document.PromptForm.PageObj); resetAll(document.PromptForm.AvailObj)');
@


1.12
log
@new bugs just found fixed, some visual changes
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.11 2003/02/21 09:29:06 jiri_schmid Exp $
d68 1
a68 1
	<tr><td align="center"><input value="$Obj->{name}" type="text" name="name" size="$name_w" maxlength="100"/></td></tr>
d71 1
a71 1
	<tr><td><textarea cols="$descr_w" rows="$descr_r" name="desc">$Obj->{description}</textarea></td></tr>
@


1.11
log
@IE save bug fixed / grid - new uknown bug when saving found, not fixed yet
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.10 2003/02/20 14:45:00 jiri_schmid Exp $
d60 1
a60 1
	<tr>	<td align="center"><IFRAME id="css_graph" src="format.html" width="100%" height="400" scrolling="auto" frameborder="0"></IFRAME>         	      
@


1.10
log
@save item bug and delete item bug fixed
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.9 2003/02/14 09:13:00 jiri_schmid Exp $
d39 1
a39 1
#	print $cgi->hidden('ID',$ID);
d74 3
a76 3
	<tr>	<td class="buttons"><button type="submit" name="Action" value="Save|$ID">$al->{'Save'}</button></td>
		<td class="buttons"><button type="reset" name="reset" value="Reset">$al->{'Reset'}</button></td>
		<td class="buttons"><button type="button" name="reload" value="Reload" onclick='reload_btn();return true;'>$al->{'Reload'}</button></td></tr>
@


1.9
log
@some code and visual improvment
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.8 2003/02/12 15:01:57 jiri_schmid Exp $
d37 1
a37 1
	print $cgi->startform(-action=>'', -name=>'format');
d39 1
a39 1
	print $cgi->hidden('ID',$ID);
d73 5
a77 6
		<table class="buttons">
		<tr>	<td class="buttons"><input type="submit" name="Action" value="$al->{'Save'}"></td>
			<td class="buttons"><input type="reset" name="reset" value="$al->{'Reset'}"></td>
			<td class="buttons"><input type="button" name="reload" value="$al->{'Reload'}" onclick='reload_btn();return true;'></td>
		</tr>
		</table>
@


1.8
log
@format_ed.pl, format.html, format_[css|graph].html fixed and tuned
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.7 2003/02/11 16:07:13 jiri_schmid Exp $
d13 1
a13 5
use vars qw($ID $Obj $ObjT $al);
my $selSize=6;
my $descr_w=35;	# width of descriprion window
my $descr_r=8;	# rows of descriprion window
my $name_w=38;	# width of name input area
d45 2
a46 2
<table><tr><td width="20"><img src="img/format_new.gif"></td><td class="neutral_bold">$al->{'Format Edit'}</td></tr></table> 

d49 1
a49 1
<td class="page_skeleton" width="350">
d64 1
@


1.7
log
@large rebuilding of format_ed.pl and linked files format[|_css|_graph].html,
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.6 2003/01/30 12:50:53 jiri_schmid Exp $
d49 1
a49 1
<table><tr><td width="20"><img src="img/format.png"></td><td class="neutral_bold">$al->{'Format Edit'}</td></tr></table> 
d55 8
a62 4
	<tr>	<td>	<input type="radio" id="in_css" name="style" value="CSS" checked="true" onclick='change_style("format_css.html");return true;'>$al->{'Format radio_btn css'}
			<input type="radio" id="in_graph" name="style" value="Graph" onclick='change_style("format_graph.html");return true;'>$al->{'Format radio_btn graph'}
			<input id="forma" value="$Obj->{css}->{type}" type="hidden" name="form" />  
			<input id="typ" value="$Obj->{graph}->{type}" type="hidden" name="type"/></td>
d99 2
a100 2
	if ($form eq 'css') {$o->{css}->{type} = $cgi->param('type')};
	if ($form eq 'graph') {$o->{graph}->{type} = $cgi->param('type')};
@


1.6
log
@Dad.js seems to be working properly
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.5 2003/01/16 17:20:20 spanhel Exp $
d45 2
d55 4
a58 4
	<tr>	<td>	<input type="radio" name="style" value="CSS" checked="true" onclick='change_style(document);return true;'>$al->{'Format radio_btn css'}
			<input type="radio" name="style" value="Graph" onclick='change_style(document);return true;'>$al->{'Format radio_btn graph'}
			<input value="$Obj->{grid}->{css}" type="hidden" name="form" />  
			<input value="$Obj->{graph}->{type}" type="hidden" name="type"/></td>
d60 1
a60 2
	<tr>	<td align="center"><IFRAME id= "f_css" src="format_css.html" width="100%" height="400" scrolling="auto" frameborder="0"></IFRAME>         	      
			<IFRAME id= "f_graph" src="format_graph.html" width="0" height="0" scrolling="auto" frameborder="0"></IFRAME></td>
d73 1
a73 1
		<tr>	<td class="buttons"><input type="submit" name="Action" value="$al->{'Save'}" onclick='setAll(RowObj);setAll(ColObj);setAll(PageObj);setAll(Metrics);return true;'></td>
a82 4




d92 1
a92 1
	delete $o->{grid};
d95 1
a95 1
	if ($form eq 'grid') {$o->{grid}->{css} = $cgi->param('type')};
@


1.5
log
@change edit.cgi - tree and object edit desided into two iframes
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.4 2002/11/26 12:44:38 spanhel Exp $
d13 1
a13 1
use vars qw($ID $Obj $ObjT);
d47 33
a79 44
        <h3>  <img class = "rubbish" src="img/format.png"> Format Edit</h3>  
       <input type="radio" name="style" value="CSS" checked="true" onclick='change_style(document);return true;'>CSS
       <input type="radio" name="style" value="Graph" onclick='change_style(document);return true;'>Graph
       <input value="$Obj->{grid}->{css}" type="hidden" name="form" />  
       <input value="$Obj->{graph}->{type}" type="hidden" name="type"/>	
	<table>
	  <tr>   	     
	    <td width="250">
	      
	      <IFRAME id= "f_css" src="format_css.html" width="100%" height="400" scrolling="auto" frameborder="0">
     	       </IFRAME>         	      
	    
	       <IFRAME id= "f_graph" src="format_graph.html" width="0" height="0" scrolling="auto" frameborder="0">
    	       </IFRAME>
	    </td>	   

	    <td valign = "top">
			<br><br><br>
		     <table class = "description" cellpading="0" cellspacing="0">
			<tr>
			    <td>
			      <div class = "text">Name:<br></div>
        		      <input value="$Obj->{name}" class="text" type="text" name="name" size="$name_w" maxlength="100"/>
			    </td>
			</tr>			

			<tr>
			    <td colspan="3">
        		      <div class="text">Description:<br></div>
			      <textarea class="text" cols="$descr_w" rows="$descr_r" name="desc">$Obj->{description}</textarea>		      
        		    </td>
			</tr>
						
			<tr>
			    <td class=main align=right>
        		      <input class="text" type="submit" name="Action" value="Save"   width="15" height="10" onclick='setAll(RowObj);setAll(ColObj);setAll(PageObj);setAll(Metrics);return true;'> 
 			      <input class="text" type="reset"  name="reset"  value="Reset"  width="15" height="10">
  			      <input class="text" type="button" name="reload" value="Reload" width="15" height="10" onclick='reload_btn();return true;'>
			    </td>
			</tr>
		     </table>
	     </td> 	     
	   </tr>
	</table>			     
@


1.4
log
@two types of format grid and graph
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.3 2002/11/22 12:54:11 spanhel Exp $
d65 1
a65 1
		     <table class = "description">
@


1.3
log
@css, copy object in tree
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.2 2002/11/01 11:49:40 spanhel Exp $
d44 2
d47 5
a51 2
 <h3>  <img class = "rubbish" src="img/format.png"> Format Edit</h3>  

d55 6
a60 2
	         <IFRAME src="format.html" width="100%" height="400" scrolling="auto" frameborder="0" >
		  </IFRAME>
d62 1
d64 1
d79 1
a79 6
			<tr>
			    <td>
			      <div class = "text">Css:<br></div>
        		      <input readonly value="$Obj->{css}[0]" class="text" type="text" name="css" size="$name_w" maxlength="100"/>
			    </td>
			</tr>			
d106 6
a111 2
	delete $o->{css};
	$o->{css} = [$cgi->param('css')];
@


1.2
log
@added dynamic tree for edit html pages, created format_ed.pl (CSS), changed cookie ID (edit.cgi)
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.1 2002/10/25 14:03:25 spanhel Exp $
d14 5
d45 44
a88 5
  
<h3>  <img class = "rubbish" src="img/format.png"> CSS Edit</h3>
  <IFRAME src="format.html" width="100%" height="300"
             scrolling="auto" frameborder="0">
  </IFRAME>
d96 10
@


1.1
log
@edit pages created
@
text
@d4 1
a4 1
# $Id: grid_ed.pl,v 1.2 2002/10/23 11:17:36 michald Exp $
a26 23
	my $cgi = shift;

	print <<END ;   # openNodes ... list of nodes which are currently open

<script language="JavaScript">
<!--

function changeCSS(idd) {
    var len = document.styleSheets.length;
    for(var i=0;i<len-1;i++) {    
            if (idd!=i) document.styleSheets[i+1].disabled=true;
            else {
	      document.styleSheets[i+1].disabled=false;       
	    }
       }
     }

     function pokus() {
       var id = document.list.list_css.selectedIndex;
       if (id!=-1) {
         changeCSS(id);
       }
     }
d28 1
a28 6
//-->
</script>

END

}
d40 5
a45 49
<h3>Table example:</h3>
<table>
    <tr>
      <td>
         <form name="list" metod="">  
	 <select name="list_css" size="4" onchange='pokus();return true;'>
	     <option value"bluesea">Blue sea
	     <option value"blueseab">Blue sea (bold)
	     <option value"greenwwod">Greenwood
    	     <option value"greenwwodb">Greenwood (bold)
	  </select>

	  </form>
       </td>
    </tr> 
<table width=100% >
 <tr>
  <td>     
    <h3>Table example:</h3>
    <table class="mains">
     <tr>
       <th class="re">Rok</th>
       <th class="ro">Obrat A</th>
       <th class="re">Obrat B</th>
     </tr>
       <th class="co">2001</th>
       <td class="o">12</td>
       <td class="o">12</td>
     <tr>
     </tr>
       <th class="ce">2002</th>
       <td class="e">15</td>
       <td class="e">16</td>
     <tr>
     </tr>
       <th class="co">2003</th>
       <td class="o">15</td>
       <td class="o">16</td>
     <tr>
     </tr>
       <th class="ce">2004</th>
       <td class="e">15</td>
       <td class="e">16</td>
     <tr>
     </tr>  
   </table>
  </td>     
 </tr>
</table>
@

