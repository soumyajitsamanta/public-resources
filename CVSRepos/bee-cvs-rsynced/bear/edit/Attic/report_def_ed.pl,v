head	1.8;
access;
symbols;
locks; strict;
comment	@# @;


1.8
date	2003.10.31.12.47.57;	author jiri_schmid;	state dead;
branches;
next	1.7;

1.7
date	2003.10.16.15.29.17;	author jiri_schmid;	state Exp;
branches;
next	1.6;

1.6
date	2003.10.16.14.08.53;	author jiri_schmid;	state Exp;
branches;
next	1.5;

1.5
date	2003.09.29.15.37.51;	author jiri_schmid;	state Exp;
branches;
next	1.4;

1.4
date	2003.09.24.14.59.18;	author jiri_schmid;	state Exp;
branches;
next	1.3;

1.3
date	2003.09.23.15.42.57;	author jiri_schmid;	state Exp;
branches;
next	1.2;

1.2
date	2003.09.18.14.07.41;	author jiri_schmid;	state Exp;
branches;
next	1.1;

1.1
date	2003.09.17.15.40.59;	author jiri_schmid;	state Exp;
branches;
next	;


desc
@@


1.8
log
@mod perl rocks!
@
text
@#-----------------------------------------------------
#  Report Editation
#-----------------------------------------------------
# $Id: report_def_ed.pl,v 1.7 2003/10/16 15:29:17 jiri_schmid Exp $

use strict;
our($itemWidth);

#-----------------------------------------------------

sub generateContent {
my($variables, $lang, $obj) = (shift, shift, shift);

my $saved = $$variables->{saved} if exists $$variables->{saved};
my $saveRun = $$variables->{saveRun} if exists $$variables->{saveRun};
my $imgType = \$$variables->{imgType};
my $skinPath = \$$variables->{skinPath};

print <<END;
<br />
<table class="page_skeleton">
<tr class="page_skeleton">
<td class="page_skeleton">
	<table class="neutral">
	<tr><td colspan="3" class="neutral_bold">$$lang->{'Report Filter'}</td></tr>
	<tr><td style='text-align:center'><img class="cursor" id="report_filter_link" onclick="newOrEdit('filter','report_filter_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/filter.$$imgType" /></td>
	    <td>
	    	<input onclick="drop_input(this)" id="report_filter" value="" type="text" size="$itemWidth" maxlength="100" readonly/>
		<input type="hidden" name="filter_id" id="report_filter_id" value="$$obj->{filter_def}"/>
	    </td>
	    <td><img class="cursor" src="${$skinPath}img/delete.$$imgType" title="$$lang->{Delete}" onclick="clearItem('report_filter')"></td>
	</tr>
	<tr><td colspan="3"><hr></td></tr>
	<tr><td colspan="3" class="neutral_bold">$$lang->{'Report Grid'}</td></tr>
	<tr><td style='text-align:center'>
		<img class="cursor" id="report_grid_link" onclick="newOrEdit('object','report_grid_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/grid.$$imgType" />
		<img class="cursor" id="report_grid_link" onclick="newOrEdit('object','report_grid_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/graph3d.$$imgType" />
	    </td>
	    <td>
	    	<input onclick="drop_input(this)" id="report_grid" value="" type="text" size="$itemWidth" maxlength="100" readonly/>
		<input type="hidden" name="object_id" id="report_grid_id" value="$$obj->{var_def}"/>
		<input type="hidden" name="report_type" id="report_type" value="$$obj->{report_type}"/>
	    </td>
	    <td><img class="cursor" src="${$skinPath}img/delete.$$imgType" title="$$lang->{Delete}" onclick="clearItem('report_grid')"></td>
	</tr>
	<tr><td colspan="3"><hr></td></tr>   
	<tr><td colspan="3" class="neutral_bold">$$lang->{'Report Format'}</td>
	</tr>
	<tr><td>
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/format.$$imgType" />
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/format2d.$$imgType" />
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$$lang->{'Edit New'}" src="${$skinPath}img/format3d.$$imgType" />
	    </td>
	    <td><input onclick="drop_input(this)" type="text" id="report_format" value="" size=$itemWidth" maxlength="100" readonly/>
	    <input type="hidden" name="format_id" id="report_format_id" value="$$obj->{format_def}"/>
	    </td>
	    <td><img class="cursor" src="${$skinPath}img/delete.$$imgType" title="$$lang->{Delete}" onclick="clearItem('report_format')"></td>
	</tr>
	<tr><td></td></tr>
	</table>
</td>
<tr class="page_skeleton">
<td class="page_skeleton">
	<table class='neutral_100'>
	<tr><td align='center'>
		<table class="buttons" style='padding:2px'>
		<tr>
		<td class="buttons"><input type="submit" style='width:100%' name="Action" value="$$lang->{'Save'}" /></td>
		<td class="buttons"><input type="submit" style='width:100%' name="Action" value="$$lang->{'Save and Run'}" /></td>
		<td class="buttons">	<input type="submit" style='width:100%' name="Action" value="$$lang->{'Save As'}" onclick="return readName();"/>
					<input type="hidden" name="saveAsName" id="saveAsName" value="" /></td>
		<td class="buttons"><input type="button" style='width:100%' name="reset" value="$$lang->{'Reset'}" onclick="subst_ID('report_filter','report_grid','report_format')" /></td>
		</tr>
		<td class='buttons' colspan='2'><input type="button" style='width:100%' value="$$lang->{'Report Run'}" onclick="run_result()"/></td>
		<td class='buttons' colspan='2'>
				<select name="report_open_in" id="report_open_in" style='width:100%'>
END
my @@open_result = ('_default','_blank','_one','_self');	#set values for open_in parameter used in user preferences
my $hlp = "";					#clear from previus text content
my $open = param('report_open_in');
my $selected;
foreach (@@open_result) {
 $selected = ($_ eq $open) ? " selected='selected'" : "";
 $hlp .= "<option value=\"$_\"$selected>".$$lang->{"Prefer OpenR $_"}."</option>";
}
print $hlp;
print <<END;
				</select>
		</td></tr>
		</table>
	</td></tr>
</td></tr>
</table>
<input type="hidden" value="$$obj->{filter_def}|$$obj->{var_def}|$$obj->{format_def}" id="ITEMS"/>
<script type="text/javascript">
<!--
	var localItem = "$$lang->{'Report Local'}";
 	subst_ID('report_filter','report_grid','report_format');
	$saveRun
	var saveAsMsg = "$$lang->{SaveAsMsg}$$lang->{'New Report'}";
	reloadTree($saved);
	var msg="$$lang->{'New Save Part1'}$$lang->{'New Report Save'}$$lang->{'New Save Part2'}";

-->
</script>
END
}

#---------------------------------------------------

sub set_next_param {
	my $o=shift;
	$o->{report_type} = param('report_type');
	$o->{var_def} = param('object_id') if (not(ref($o->{var_def}) =~ /HASH/ && param('object_id') =~ /HASH/));
	$o->{filter_def} = param('filter_id') if (not(ref($o->{filter_def}) =~ /HASH/ && param('filter_id') =~ /HASH/));
	$o->{format_def} = param('format_id') if (not(ref($o->{format_def}) =~ /HASH/ && param('format_id') =~ /HASH/));

}

1
@


1.7
log
@some fixies due to mod-perl changes
@
text
@d4 1
a4 1
# $Id: report_def_ed.pl,v 1.6 2003/10/16 14:08:53 jiri_schmid Exp $
@


1.6
log
@mod-perl implementation stage 1, rebuilding global vars in .pl to global pointers
@
text
@d4 1
a4 1
# $Id: report_def_ed.pl,v 1.5 2003/09/29 15:37:51 jiri_schmid Exp $
d76 1
a76 1
				<select name="report_open_in" style='width:100%'>
@


1.5
log
@report result parameters handling changed, minor code improvments
@
text
@d4 1
a4 1
# $Id: report_def_ed.pl,v 1.4 2003/09/24 14:59:18 jiri_schmid Exp $
d7 1
a7 2
use CGI qw( :standard );
use CGI::Pretty;
d9 1
a9 2
require "const.def";
require "local_lib.pl";
d11 2
a12 1
use vars qw($ID $Obj $ObjT $ObjPref $descr_w $descr_r $name_w $use_lang $open $sqlCols $sqlRows $saved $itemWidth @@Languages $DefaultLanguage $skin $imgType $skinPath $saveRun);
d14 4
a17 1
#-----------------------------------------------------
a18 3
sub generateContent {
#use Data::Dumper;
#print "<pre>".Dumper($Obj)."</pre>";
d25 2
a26 2
	<tr><td colspan="3" class="neutral_bold">$lang->{'Report Filter'}</td></tr>
	<tr><td style='text-align:center'><img class="cursor" id="report_filter_link" onclick="newOrEdit('filter','report_filter_id')" title="$lang->{'Edit New'}" src="${skinPath}img/filter.$imgType" /></td>
d29 1
a29 1
		<input type="hidden" name="filter_id" id="report_filter_id" value="$Obj->{filter_def}"/>
d31 1
a31 1
	    <td><img class="cursor" src="${skinPath}img/delete.$imgType" title="$lang->{Delete}" onclick="clearItem('report_filter')"></td>
d34 1
a34 1
	<tr><td colspan="3" class="neutral_bold">$lang->{'Report Grid'}</td></tr>
d36 2
a37 2
		<img class="cursor" id="report_grid_link" onclick="newOrEdit('object','report_grid_id')" title="$lang->{'Edit New'}" src="${skinPath}img/grid.$imgType" />
		<img class="cursor" id="report_grid_link" onclick="newOrEdit('object','report_grid_id')" title="$lang->{'Edit New'}" src="${skinPath}img/graph3d.$imgType" />
d41 2
a42 2
		<input type="hidden" name="object_id" id="report_grid_id" value="$Obj->{var_def}"/>
		<input type="hidden" name="report_type" id="report_type" value="$Obj->{report_type}"/>
d44 1
a44 1
	    <td><img class="cursor" src="${skinPath}img/delete.$imgType" title="$lang->{Delete}" onclick="clearItem('report_grid')"></td>
d47 1
a47 1
	<tr><td colspan="3" class="neutral_bold">$lang->{'Report Format'}</td>
d50 3
a52 3
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$lang->{'Edit New'}" src="${skinPath}img/format.$imgType" />
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$lang->{'Edit New'}" src="${skinPath}img/format2d.$imgType" />
		<img class="cursor" onclick="newOrEdit('format','report_format_id')" title="$lang->{'Edit New'}" src="${skinPath}img/format3d.$imgType" />
d55 1
a55 1
	    <input type="hidden" name="format_id" id="report_format_id" value="$Obj->{format_def}"/>
d57 1
a57 1
	    <td><img class="cursor" src="${skinPath}img/delete.$imgType" title="$lang->{Delete}" onclick="clearItem('report_format')"></td>
d68 3
a70 3
		<td class="buttons"><input type="submit" style='width:100%' name="Action" value="$lang->{'Save'}" /></td>
		<td class="buttons"><input type="submit" style='width:100%' name="Action" value="$lang->{'Save and Run'}" /></td>
		<td class="buttons">	<input type="submit" style='width:100%' name="Action" value="$lang->{'Save As'}" onclick="return readName();"/>
d72 1
a72 1
		<td class="buttons"><input type="button" style='width:100%' name="reset" value="$lang->{'Reset'}" onclick="subst_ID('report_filter','report_grid','report_format')" /></td>
d74 1
a74 1
		<td class='buttons' colspan='2'><input type="button" style='width:100%' value="$lang->{'Report Run'}" onclick="run_result()"/></td>
d84 1
a84 1
 $hlp .= "<option value=\"$_\"$selected>".$lang->{"Prefer OpenR $_"}."</option>";
d94 1
a94 1
<input type="hidden" value="$Obj->{filter_def}|$Obj->{var_def}|$Obj->{format_def}" id="ITEMS"/>
d97 1
a97 1
	var localItem = "$lang->{'Report Local'}";
d100 1
a100 1
	var saveAsMsg = "$lang->{SaveAsMsg}$lang->{'New Report'}";
d102 1
a102 1
	var msg="$lang->{'New Save Part1'}$lang->{'New Report Save'}$lang->{'New Save Part2'}";
@


1.4
log
@graph2d improvments
@
text
@d4 1
a4 1
# $Id: report_def_ed.pl,v 1.3 2003/09/23 15:42:57 jiri_schmid Exp $
d65 3
a67 1
	<table class="neutral_100" style='padding:2px'>
d74 19
a92 3
	</tr>

	</table>
@


1.3
log
@bug fixies, web browser oriented skins implemented
@
text
@d4 1
a4 1
# $Id: report_def_ed.pl,v 1.2 2003/09/18 14:07:41 jiri_schmid Exp $
d20 1
a20 17
my ($mapImg,$formatImg);
if (defined $Obj->{report_type}) {
	if ($Obj->{report_type} eq "grid") {
		$mapImg = "'${skinPath}img/grid.$imgType'";
		$formatImg = "'${skinPath}img/format.$imgType'";
	} elsif ($Obj->{report_type} eq "graph3d") {
		$mapImg = "'${skinPath}img/graph3d.$imgType'";
		$formatImg = "'${skinPath}img/format3d.$imgType'";
	} else {
	$mapImg = "'${skinPath}img/gear.$imgType'";
	$formatImg = "'${skinPath}img/format2d.$imgType'";
	}
} else {
	$mapImg = "'${skinPath}img/gear.$imgType'";
	$formatImg = "'${skinPath}img/format.$imgType'";
}	
print <<END ;
d27 1
a27 1
	<tr><td><img class="cursor" id="report_filter_link" onclick="newOrEdit('filter','report_filter_id')" title="$lang->{'Edit New'}" src="${skinPath}img/filter.$imgType" /></td>
d36 4
a39 1
	<tr><td><img class="cursor" id="report_grid_link" onclick="newOrEdit('object','report_grid_id')" title="$lang->{'Edit New'}" src=$mapImg /></td>
d50 5
a54 1
	<tr><td><img class="cursor" id="report_format_link" onclick="newOrEdit('format','report_format_id')" title="$lang->{'Edit New'}" src=$formatImg /></td>
d71 1
a71 1
		<td class="buttons"><input type="button" style='width:100%' name="reset" value="$lang->{'Reset'}" onclick="subst_ID('report_filter','report_grid','report_format'); changeIcons('$Obj->{report_type}')" /></td>
@


1.2
log
@tabs imlemented almost everywhere
@
text
@d4 1
a4 1
# $Id: report_def_ed.pl,v 1.1 2003/09/17 15:40:59 jiri_schmid Exp $
d30 1
a30 1
	$formatImg = "'${skinPath}img/format2.$imgType'";
d34 1
a34 1
	$formatImg = "'${skinPath}img/format2.$imgType'";
@


1.1
log
@report tab changes
@
text
@d4 1
a4 1
# $Id: report_main_ed.pl,v 1.26 2003/09/17 14:51:14 jiri_schmid Exp $
d76 1
a77 1
		<td class="buttons"><input type="submit" style='width:100%' name="Action" value="$lang->{'Save'}" /></td>
@

