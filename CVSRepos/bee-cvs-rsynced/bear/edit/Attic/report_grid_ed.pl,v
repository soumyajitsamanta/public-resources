head	1.8;
access;
symbols;
locks; strict;
comment	@# @;


1.8
date	2003.07.18.10.58.21;	author jiri_schmid;	state dead;
branches;
next	1.7;

1.7
date	2003.05.19.14.32.32;	author jiri_schmid;	state Exp;
branches;
next	1.6;

1.6
date	2003.05.19.14.18.35;	author jiri_schmid;	state Exp;
branches;
next	1.5;

1.5
date	2003.05.16.11.28.26;	author jiri_schmid;	state Exp;
branches;
next	1.4;

1.4
date	2003.05.14.15.36.46;	author jiri_schmid;	state Exp;
branches;
next	1.3;

1.3
date	2003.05.14.14.28.21;	author jiri_schmid;	state Exp;
branches;
next	1.2;

1.2
date	2003.05.13.15.19.00;	author jiri_schmid;	state Exp;
branches;
next	1.1;

1.1
date	2003.05.08.15.35.51;	author jiri_schmid;	state Exp;
branches;
next	;


desc
@@


1.8
log
@removed files
@
text
@#-----------------------------------------------------
#  Report Editation
#-----------------------------------------------------
# $Id: report_grid_ed.pl,v 1.7 2003/05/19 14:32:32 jiri_schmid Exp $

use strict;
use CGI qw( :standard );
use CGI::Pretty;

require "const.def";
require "local_lib.pl";

use vars qw($ID $Obj $ObjT $ObjPref $descr_w $descr_r $name_w $use_lang $open $sqlCols $sqlRows $lang $ObjectAttr $MetricsIdent $saved);

#-----------------------------------------------------

sub generateContent {
my $copy = shift;

if ($copy) {
my $hlp;
	if ($copy eq '1') {
		loadMetadata($Obj->{grid_def});
		$hlp->{grid_def} = $Obj;
	} else {
		$hlp->{grid_def}->{empty} = "";
	};
$Obj = $hlp;
};

if (ref($Obj->{grid_def})) {

print <<END ;
<script src='js/report.js' type='text/javascript'></script>
<br>
<table class="page_skeleton">
<tr class="page_skeleton">
<td class="page_skeleton_ex" width="325" align="center">
END
&generateGridEdit();
print "</td><td>";
&generateGridEditFields();
print <<END ;
</td></tr>
<tr class="page_skeleton">
<td class="page_skeleton">
	<table class="neutral_100">
	<tr><td align="right">
		<table class="buttons" cellpading="0" cellspacing="0">
		<tr>	<td class="buttons"><input type="submit" name="Action" value="$lang->{'Save'}" onclick="fill_selects()" /></td>
			<td class="buttons">	<input type="submit" name="Action" value="$lang->{'Save As'}" onclick="fill_selects(); return readName();"/>
						<input type="hidden" name="saveAsName" id="saveAsName" value="" /></td>
			<td class="buttons"><input type="button" name="reset" value="$lang->{'Reset'}" onclick="fill_tables()" /></td>
		</tr>
		</table>
	</td></tr>
	</table>
</td><td>
</table>
<script type="text/javascript" src="js/grid.js"></script>
<script type="text/javascript">
<!--
	var mg_img="$ObjectAttr->{$MetricsIdent}->{img}";
	var msg="$lang->{'New Save Part1'}$lang->{'New Grid Save'}$lang->{'New Save Part2'}";
	var saveAsMsg = "$lang->{SaveAsMsg}$lang->{'New Grid'}";
	reloadTree($saved);
	fill_tables();
-->
</script>
END

} else {
print "<p><b>&nbsp;$lang->{'Report Lgrid'}</b>$lang->{'Report No Grid'}<ul>";
if ($Obj->{grid_def}) {
	print "<li><a href=\"javascript: editOriginal('$Obj->{grid_def}','G');\">$lang->{'Report Global Edit'}</a></li>";
	print "<li><a href=\"javascript: editLocal('grid','1');\">$lang->{'Report Local Edit'}</a></li>";
};
print "<li><a href=\"javascript: editLocal('grid');\">$lang->{'Report New Local'}</a></li></ul>";
}} 


#---------------------------------------------------

sub set_next_param {
	my($cgi) = shift;
	my $o=shift;
#use Data::Dumper;
#print "<pre>".Dumper($Obj)."</pre>";
my $hlp;
#print ref($o->{grid});
	$hlp->{orig_id} = (ref($o->{grid_def})) ? $o->{grid_def}->{orig_id} : $o->{grid_def};
	$hlp->{row} = [param('RowObj')];
	$hlp->{col} = [param('ColObj')];
	$hlp->{page} = [param('PageObj')];
	$hlp->{metric} = [param('Metrics')];
$o->{grid_def} = $hlp;
}

1
@


1.7
log
@save-as bug when canceling saving fixed
@
text
@d4 1
a4 1
# $Id: report_grid_ed.pl,v 1.6 2003/05/19 14:18:35 jiri_schmid Exp $
@


1.6
log
@very minor fixies and code improvmetns
@
text
@d4 1
a4 1
# $Id: report_grid_ed.pl,v 1.5 2003/05/16 11:28:26 jiri_schmid Exp $
d51 1
a51 1
			<td class="buttons">	<input type="submit" name="Action" value="$lang->{'Save As'}" onclick="readName();fill_selects()"/>
@


1.5
log
@report page - save as functionality implemented
@
text
@d4 1
a4 1
# $Id: report_grid_ed.pl,v 1.4 2003/05/14 15:36:46 jiri_schmid Exp $
d75 1
a75 1
	print "<li><a href=\"javascript: editOriginal('$Obj->{grid}','G');\">$lang->{'Report Global Edit'}</a></li>";
@


1.4
log
@minor code improvments
@
text
@d4 1
a4 1
# $Id: report_grid_ed.pl,v 1.3 2003/05/14 14:28:21 jiri_schmid Exp $
d13 1
a13 1
use vars qw($ID $Obj $ObjT $ObjPref $descr_w $descr_r $name_w $use_lang $open $sqlCols $sqlRows $lang $ObjectAttr $MetricsIdent);
d51 2
d65 2
@


1.3
log
@next report improvment
@
text
@d4 1
a4 1
# $Id: report_grid_ed.pl,v 1.2 2003/05/13 15:19:00 jiri_schmid Exp $
d41 2
d57 1
a57 6
END
&generateGridEditFields();
print "</td></tr></table>";

print <<END ;

@


1.2
log
@new report page seems to be fullfunctional, javascript code huge improvment
@
text
@d4 1
a4 1
# $Id: report_grid_ed.pl,v 1.1 2003/05/08 15:35:51 jiri_schmid Exp $
d13 1
a13 1
use vars qw($ID $Obj $ObjT $ObjPref $descr_w $descr_r $name_w $use_lang $open $sqlCols $sqlRows);
d19 1
d22 7
a28 7
if ($copy eq '1') {
	loadMetadata($Obj->{grid});
	$hlp->{'expr'} = $Obj->{expr};
} else {
	$hlp->{'expr'} = "";
};
$Obj->{grid} = $hlp;
d31 1
a31 1
if (ref($Obj->{grid})) {
d41 1
a41 1
print <<END ; 
d49 1
a49 1
			<td class="buttons"><input type="button" name="reset" value="$lang->{'Reset'}" /></td>
d54 1
a54 2
</td></tr>
</table>
a55 1

d57 1
d60 1
d63 1
d67 1
d72 2
a73 3
print "<ul><b>$lang->{'Report Lgrid'}</b>";
if ($Obj->{grid}) {
	print "$lang->{'Report No Grid'}";
d86 2
d89 2
a90 1
	$hlp->{orig_grid} = (ref($o->{grid})) ? $o->{grid}->{'orig_filter'} : $o->{grid};
d94 2
a95 2
	$hlp->{metric} = [param('Metrics')];	# nemely by metriky byt vnoreny do row|col|page ?
$o->{grid} = $hlp;
@


1.1
log
@report huge improvment
@
text
@d4 1
a4 1
# $Id: report_ed.pl,v 1.40 2003/05/08 07:42:46 michald Exp $
d18 40
a58 1
print "<script src='js/report.js' type='text/javascript'></script>";
d60 6
a65 2
<pre>tady bude jednou lokalni grid, ale bude to vubec vhodny, aby tady byl?
dyt to bude v podstate uplne novej report</pre>
d67 11
a77 1
}
d80 12
@

