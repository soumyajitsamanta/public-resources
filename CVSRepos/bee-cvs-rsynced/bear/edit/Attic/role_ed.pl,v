head	1.9;
access;
symbols;
locks; strict;
comment	@# @;


1.9
date	2003.10.16.14.08.53;	author jiri_schmid;	state dead;
branches;
next	1.8;

1.8
date	2003.10.13.14.43.23;	author jiri_schmid;	state Exp;
branches;
next	1.7;

1.7
date	2003.09.19.10.23.50;	author jiri_schmid;	state Exp;
branches;
next	1.6;

1.6
date	2003.09.01.12.40.09;	author jiri_schmid;	state Exp;
branches;
next	1.5;

1.5
date	2003.08.26.15.35.45;	author jiri_schmid;	state Exp;
branches;
next	1.4;

1.4
date	2003.08.22.16.01.03;	author jiri_schmid;	state Exp;
branches;
next	1.3;

1.3
date	2003.08.21.14.23.31;	author jiri_schmid;	state Exp;
branches;
next	1.2;

1.2
date	2003.08.21.12.02.14;	author jiri_schmid;	state Exp;
branches;
next	1.1;

1.1
date	2003.08.20.14.24.56;	author jiri_schmid;	state Exp;
branches;
next	;


desc
@@


1.9
log
@mod-perl implementation stage 1, rebuilding global vars in .pl to global pointers
@
text
@#-----------------------------------------------------
#  Format Editation
#-----------------------------------------------------
# $Id: role_ed.pl,v 1.8 2003/10/13 14:43:23 jiri_schmid Exp $

use strict;
use CGI qw( :standard );
use CGI::Pretty;

require "const.def";

use vars qw($ID $Obj $ObjT $use_lang $open $lang $all_params $localTab $skin $skinPath $imgType $DefaultLanguage);


#-----------------------------------------------------
# print_form is called from edit.cgi

sub print_form {
	print hidden('ObjT',$ObjT);
	print hidden('skin',$skin);
	print hidden('all_params',$all_params);
	print hidden('local_tab',$localTab);
	my $name = LocalizedObj($Obj->{name}, "Object #$ID", lc($use_lang), $DefaultLanguage);
print <<END ;
<input type="hidden" value="$use_lang" id="activeLang" name="active_lang" />
<input type="hidden" value="$skin" id="skin" name="skin" />
<input type="hidden" value="$imgType" id="imgType" />
<input type='hidden' name='item_id' id='ITEM_ID' value='$ID'/>
<table><tr>
	<td style='width:20px'><img src="${skinPath}img/role.$imgType"></td>
	<td class="neutral_title">$lang->{'Role'}</td>
	<td style='font-size:80%; font-weight:bold; vertical-align:bottom'>$lang->{'Read Only'}</td>
	<td >- $name</td>
</tr></table>
END
&generateTabs($localTab,'Role','urole','def');
print "<table class='local_tabline' cellspacing='0'><tr><td>\n";
&generateContent();
print "</td></tr><tr><td>&nbsp;</td></tr></table>";
print "<script type='text/javascript'>var params = '$all_params';</script>";
print &endform;
END
}

1
@


1.8
log
@description tab defined under two files, bug fixies
@
text
@d4 1
a4 1
# $Id: role_ed.pl,v 1.7 2003/09/19 10:23:50 jiri_schmid Exp $
@


1.7
log
@fixies
@
text
@d4 1
a4 1
# $Id: role_ed.pl,v 1.6 2003/09/01 12:40:09 jiri_schmid Exp $
d32 1
@


1.6
log
@skins implemented. mozilla skin - temporarily copy msie content
@
text
@d4 1
a4 1
# $Id: role_ed.pl,v 1.5 2003/08/26 15:35:45 jiri_schmid Exp $
d12 1
a12 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w $lang $saved @@Languages $DefaultLanguage $use_lang $iframeHeight $all_params $skin $skinPath $imgType);
d22 2
a23 2
	print "<input type=\"hidden\" value=\"$use_lang\" id=\"activeLang\" name=\"active_lang\">\n";

d25 9
a33 31
<table><tr><td width="20"><img src="${skinPath}img/role.$imgType"></td><td class="neutral_title">$lang->{'Role'}</td></tr></table>
<br>
<table class="page_skeleton">
<tr class="page_skeleton">
<td class="page_skeleton">
	<table class="neutral">
	<tr><td class="neutral_bold">$lang->{'Name'}</td></tr>
	<tr><td align="center">
		<span class='nowrap'>
		<input value="" onchange="object_changed()" type="text" readonly='readonly' name="name" id="NAME" size="$name_w" maxlength="100"/>
		<select name="langSpec" id="langSpec" onchange="tmpChangeLocal()">
END
foreach (@@Languages) {
	my $lcL = lc($_);
	my $name = LocalizedObj($Obj->{name}, "Object #$ID", $lcL, $DefaultLanguage);
	print "<option value='$name'>$_</option>";
}
print <<END;
		</select>
		<input type="hidden" name="item_id" id="ITEM_ID" value="$ID"/>
		</span>
	</td></tr>
	<tr><td><hr></td></tr>
	<tr><td class="neutral_bold">$lang->{'Description'}</td></tr>
	<tr><td align="center"><textarea readonly='readonly' onchange="object_changed()" cols="$descr_w" rows="$descr_r" name="desc" id="DESC"></textarea></td></tr>
	<tr><td><hr></td></tr>
	<tr><td>
			<table class='visual_grid' style='border-collapse:collapse; width:100%'>
			<tr><td></td><td style='text-align:center'>&nbsp;$lang->{'Read'}&nbsp;</td><td style='text-align:center'>$lang->{'Execute'}</td><td style='text-align:center'>&nbsp;$lang->{'Write'}&nbsp;</td><td style='text-align:center'>$lang->{'Duplicate'}</td></tr>
			<tr>
			<td class='neutral_bold'>$lang->{'Right'}:</td>
d35 6
a40 23
	foreach ('R','W','E','D') {
		my $name = "rights$_";
		my $checked = ($Obj->{rights} =~ /$_/) ? "checked='checked'" : "";
		print "<td style='text-align:center'><input disabled='disabled' type='checkbox' $checked/></td>";
	}
print <<END;
		</tr></table>
	</td></tr>	
	<tr><td><hr></td></tr>
	<tr><td align="center">
	<table class="buttons" cellpading="0" cellspacing="0">
	<tr>
		<td class="buttons"><input type="button" name="reset" value="$lang->{'Reset'}" onclick="subst_item_id();" /></td>
	</tr>
	</table>
	</td></tr>
	</table>
</td></tr></table>
<script type="text/javascript">
	subst_item_id();
	var saveAsMsg = "$lang->{SaveAsMsg}$lang->{'New Role'}";
	reloadTree($saved);
</script>
a41 4
}

#---------------------------------------------------
sub set_next_param {
@


1.5
log
@rights improvment, create delete duplicate rule implemented
@
text
@d4 1
a4 1
# $Id: role_ed.pl,v 1.4 2003/08/22 16:01:03 jiri_schmid Exp $
d12 1
a12 1
use vars qw($ID $Obj $ObjT $descr_w $descr_r $name_w $lang $saved @@Languages $DefaultLanguage $use_lang $iframeHeight);
d20 2
d25 1
a25 1
<table><tr><td width="20"><img src="img/role.gif"></td><td class="neutral_title">$lang->{'Role'}</td></tr></table>
@


1.4
log
@access - rules changing implemented
@
text
@d4 1
a4 1
# $Id: role_ed.pl,v 1.3 2003/08/21 14:23:31 jiri_schmid Exp $
d51 1
a51 1
			<tr><td></td><td style='text-align:center'>&nbsp;$lang->{'Read'}&nbsp;</td><td style='text-align:center'>$lang->{'Execute'}</td><td style='text-align:center'>&nbsp;$lang->{'Write'}&nbsp;</td></tr>
d55 1
a55 1
	foreach ('R','W','E') {
@


1.3
log
@role implementation next step
@
text
@d4 1
a4 1
# $Id: role_ed.pl,v 1.2 2003/08/21 12:02:14 jiri_schmid Exp $
a18 1
	print startform(-action=>'', -name=>'role', onsubmit=>'return reset_tree_name();');
d32 1
a32 1
		<input value="" onchange="object_changed()" type="text" name="name" id="NAME" size="$name_w" maxlength="100"/>
d47 16
a62 1
	<tr><td align="center"><textarea onchange="object_changed()" cols="$descr_w" rows="$descr_r" name="desc" id="DESC"></textarea></td></tr>
d66 1
a66 3
	<tr>	<td class="buttons"><input type="submit" name="Action" value="$lang->{'Save'}" onclick="check_name()"/></td>
			<td class="buttons">	<input type="submit" name="Action" value="$lang->{'Save As'}" onclick="return readName();"/>
						<input type="hidden" name="saveAsName" id="saveAsName" value="" /></td>
a67 1
		<td class="buttons"><input type="submit" name="Rights" value="$lang->{'Right'}"/></td>
@


1.2
log
@description for access tree changes
@
text
@d4 1
a4 1
# $Id: role_ed.pl,v 1.1 2003/08/20 14:24:56 jiri_schmid Exp $
d55 1
a55 1
		<td class="buttons"><input type="button" name="reset" value="$lang->{'Reset'}" onclick="subst_item_id(); self.frames['format'].location.reload(true)"/></td>
@


1.1
log
@role edit page
@
text
@d4 1
a4 1
# $Id: format_ed.pl,v 1.44 2003/08/13 14:22:03 jiri_schmid Exp $
a71 4
	my $o=shift;
	$o->{type} = param('type');
	$o->{form} = param('form');
	$o->{header} = param('header');
@

