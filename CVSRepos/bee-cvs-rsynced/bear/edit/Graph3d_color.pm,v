head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2004.03.18.16.27.20;	author vacula;	state Exp;
branches;
next	1.2;

1.2
date	2003.11.18.14.38.40;	author jiri_schmid;	state Exp;
branches;
next	1.1;

1.1
date	2003.10.31.12.47.57;	author jiri_schmid;	state Exp;
branches;
next	;


desc
@@


1.3
log
@undefine implicit color
@
text
@#-----------------------------------------------------
#  Grid Editation
#-----------------------------------------------------
# $Id: Graph3d_color.pm,v 1.2 2003/11/18 14:38:40 jiri_schmid Exp $

package Graph3d_color;

use strict;
require "local/Graph3d_lib.pm";

#-----------------------------------------------------
sub generateContent() {
my($variables, $lang, $obj) = (shift, shift, shift);
my $saved = $$variables->{saved} if exists $$variables->{saved};
my $localTab = $$variables->{localTab};
my $imgType = \$$variables->{imgType};
my $skinPath = \$$variables->{skinPath};

my ($fill, $shape, $itemsType);
print "<br><table class='page_skeleton'><tr class='page_skeleton'><td class='page_skeleton_ex' align='center'>";
if (&Graph3d_lib::existsDefinition($obj,$localTab)) {
if (@@{$$obj->{$localTab}{items}} == 0) {
	print "<span style='padding: 15px; line-height: 30px'>$$lang->{'Report Qualitative'}</span>";
} else {
my ($rowspan, $check);
if ($$obj->{$localTab}{quantity} eq "on") {
	$rowspan = "rowspan='3'";
	$check = "onchange='checkNum(this)'";
};
$$obj->{$localTab}{def} = "120,40,80" if !$$obj->{$localTab}{def};
my @@colors = split(/,/,$$obj->{$localTab}{def});

print <<END;
	<table style='text-align:left;width:100%'>
	<tr>	<th style='white-space:nowrap'>$$lang->{'Graph3d default'}</td>
		<td><input onfocus='setSelf(this)' ondblclick='setColor(this)' type='text' name='default' id='default0' size='10' value='$$obj->{$localTab}{default}'/></td>
		<td $rowspan>
			<table class='neutral_100' style="text-align:center"><tr>
				<td colspan='5'>$$lang->{'Graph3d color'}:</td>
			</tr><tr>
				<td id='color' class='cursor' style='background-color:rgb($$obj->{$localTab}{def}); width:100px' title='$$obj->{$localTab}{def}' onclick='addColor(this)' rowspan='4'>&nbsp</td>
				<td style='text-align:right; color:#f00'>$$lang->{'Graph3d red'}</td><td><img class='cursor' onclick='minus("red")' src='$${skinPath}img/downArr.$$imgType' onmousedown="startDecrease('red')" onmouseup='stopTimer()'></td><td><input id='red' size='4' style='text-align:center' type='text' value='$colors[0]' onchange='changeColor()'/></td><td><img onclick='plus("red")' class='cursor' style='padding:2px' src='$${skinPath}img/upArr.$$imgType' onmousedown="startIncrease('red')" onmouseup='stopTimer()'></td>
			</tr><tr>
				<td style='text-align:right; color:#0f0'>$$lang->{'Graph3d green'}</td><td><img class='cursor' onclick='minus("green")' src='$${skinPath}img/downArr.$$imgType' onmousedown="startDecrease('green')" onmouseup='stopTimer()'></td><td><input id='green' type='text' style='text-align:center' size='4' value='$colors[1]' onchange='changeColor()'/></td><td><img onclick='plus("green")' class='cursor' style='padding:2px' src='$${skinPath}img/upArr.$$imgType' onmousedown="startIncrease('green')" onmouseup='stopTimer()'></td>
			</tr><tr>
				<td style='text-align:right; color:#00f'>$$lang->{'Graph3d blue'}</td><td><img class='cursor' onclick='minus("blue")' src='$${skinPath}img/downArr.$$imgType' onmousedown="startDecrease('blue')" onmouseup='stopTimer()'></td><td><input id='blue' type='text' style='text-align:center' size='4' value='$colors[2]' onchange='changeColor()'/></td><td><img onclick='plus("blue")' class='cursor' style='padding:2px' src='$${skinPath}img/upArr.$$imgType' onmousedown="startIncrease('blue')" onmouseup='stopTimer()'></td>
			</tr>
		</table>
	</td></tr>
END
	if ($rowspan) {
		print "<tr><th style='white-space:nowrap'>$$lang->{'Min'}</th><td><input onfocus='setSelf(this); setBin(this)' $check size='10' type='text' name='min' id='inputmin' value='$$obj->{$localTab}{min}'/></td></tr>";
		print "<tr><th style='white-space:nowrap'>$$lang->{'Max'}</th><td><input onfocus='setSelf(this); setBin(this)' $check size='10' type='text' name='max' id='inputmax' value='$$obj->{$localTab}{max}'/></td></tr>";
	}
	my @@ids;
	print "<tr><td colspan='3'><hr/></td></tr>";
	my $name = "Graph3d Item$localTab";
	print "<tr><th style='text-align:left' colspan='2'>$$lang->{$name}</th><td style='text-align:right'><img class='cursor' src='$${skinPath}img/delete.$$imgType' title=\"$$lang->{'Delete Active'}\" onclick='emptyBin()'></td></tr></table>";	
	print "<table style='text-align:left; width:100%'>";
	if (SOAP->GetObjectType(${$$obj->{$localTab}{items}}[$#{$$obj->{$localTab}{items}}]) =~ /metric/) {
		$itemsType = "<input type='hidden' value='1' name='metric' />";
		foreach (0..$#{$$obj->{$localTab}{items}}) {
		print "<tr><td colspan='4'><hr/></td></tr>";
			my $id = @@{$$obj->{$localTab}{items}}[$_];
			my $end = sprintf("%.0f",8/@@{$$obj->{$localTab}{items}});
			my $rowspan = $end+2;
			print "<tr><td style='text-align:center' rowspan='$rowspan'><span id='$id'>$id</span>:</td><td style='text-align:center'>$$lang->{'Graph3d Interval'}</td><td style='text-align:center'>$$lang->{'Graph3d Size'}</td><td></td></tr>";
				for my $cnt (0..$end) {
				my $index1 = $cnt * 2;
				my $index2 = $cnt * 2 + 1;
				print "<tr><td><input type='text' style='width:100%' name='view${_}$cnt' value='$$obj->{$localTab}{rules}[$_][$index1]' onfocus='setBin(this)'/></td><td><input type='text' style='width:100%' ondblclick='setColor(this)' value='$$obj->{$localTab}{rules}[$_][$index2]' name='change${_}$cnt' id='change${_}$cnt' onfocus='setSelf(this); setBin(this)' /></td><td class='cursor' id='color${_}$cnt' onclick='reloadColor(this)' style='background-color:rgb($$obj->{$localTab}{rules}[$_][$index2]); width:25px'></td></tr>";
				}
			push(@@ids,$id);
		}
	} else {
		print "<tr>";
		foreach (0..$#{$$obj->{$localTab}{items}}) {
			my $id = @@{$$obj->{$localTab}{items}}[$_];
			push(@@ids,$id);
			print "<td style='text-align:center'><span class='cursor' title=\"$$lang->{'Elements show'}\" id='$id' onclick='loadElement(this)'>$id</span>:</td>"; 
		}
		print "<td style='text-align:center'>$$lang->{'Graph3d Size'}</td><td>&nbsp</td></tr>";
		my $plusOne = @@{$$obj->{$localTab}{items}};
		for my $cnt (0..5) {
			print "<tr>";
			foreach (0..$#{$$obj->{$localTab}{items}}) {
				print "<td><input type='text' style='width:100%' name='view${cnt}_${_}' value=\"$$obj->{$localTab}{rules}[$cnt][$_]\" onfocus='setBin(this)' onclick='addValue(this)'/></td>"; 
				}
			print "<td><input type='text' style='width:100%' value='$$obj->{$localTab}{rules}[$cnt][$plusOne]' name='change${cnt}' id='change$cnt' ondblclick='setColor(this)' onfocus='setSelf(this); setBin(this)' /></td><td class='cursor' id='color$cnt' onclick='reloadColor(this)' style='background-color:rgb($$obj->{$localTab}{rules}[$cnt][$plusOne]); width:25px'></td>";
			print "</tr>";
		}
	}
	print "</table>";
	print "<input type='hidden' id='ids' value='".join("|",@@ids)."'/>";
	$fill = "fillAxis(true);";
print <<END;
	</td></tr>	
	<tr class="page_skeleton">
	<td class="page_skeleton">
		<table class="neutral_100">
		<tr><td align="center">
			<table class="buttons" cellpading="0" cellspacing="0">
			<tr>	<td class="buttons"><input id='SAVE' type="submit" name="Action" value="$$lang->{'Save'}" /></td>
				<td class="buttons">
						<input type="submit" name="Action" value="$$lang->{'Save As'}" onclick="return readName();"/>
						<input type="hidden" name="saveAsName" id="saveAsName" value="" />
				</td>
				<td class="buttons"><input type="reset" name="reset" value="$$lang->{'Reset'}" /></td>
			</tr>
			</table>
		</td></tr>
		</table>
	</td></tr>
END
}
}
print <<END;
</td></tr>
</table>
$itemsType
<script type="text/javascript" src="js/graph3d.js"></script>
<script type="text/javascript">
	var msg="$$lang->{'New Save Part1'}$$lang->{'New Graph3d Save'}$$lang->{'New Save Part2'}";
	var saveAsMsg = "$$lang->{SaveAsMsg}$$lang->{'New Graph3d'}";
	reloadTree($saved);
	$fill
</script>
END
}

#---------------------------------------------------

sub set_next_param {
my ($o,$q,$localTab) = (shift,shift,shift);
&Graph3d_lib::saveDTSC($q,$o,$localTab);
}


1
@


1.2
log
@auto save when changing tabs implemented
@
text
@d4 1
a4 1
# $Id: Graph3d_color.pm,v 1.1 2003/10/31 12:47:57 jiri_schmid Exp $
d30 2
a31 2
$$obj->{$localTab}{default} = "120,40,80" if !$$obj->{$localTab}{default};
my @@colors = split(/,/,$$obj->{$localTab}{default});
d41 1
a41 1
				<td id='color' class='cursor' style='background-color:rgb($$obj->{$localTab}{default}); width:100px' title='$$obj->{$localTab}{default}' onclick='addColor(this)' rowspan='4'>&nbsp</td>
@


1.1
log
@mod perl rocks!
@
text
@d4 1
a4 1
# $Id: graph3d_color_ed.pl,v 1.20 2003/10/17 11:36:16 jiri_schmid Exp $
d103 1
a103 1
			<tr>	<td class="buttons"><input type="submit" name="Action" value="$$lang->{'Save'}" /></td>
@

