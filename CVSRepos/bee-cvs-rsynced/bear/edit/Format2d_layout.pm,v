head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2004.04.16.16.19.18;	author vacula;	state Exp;
branches;
next	1.2;

1.2
date	2003.11.18.14.38.40;	author jiri_schmid;	state Exp;
branches;
next	1.1;

1.1
date	2003.10.31.12.47.57;	author jiri_schmid;	state Exp;
branches;
next	;


desc
@@


1.3
log
@changes for new interface
@
text
@#-----------------------------------------------------
#  Format Editation
#-----------------------------------------------------
# $Id: Format2d_layout.pm,v 1.2 2003/11/18 14:38:40 jiri_schmid Exp $

package Format2d_layout;

use strict;
#-----------------------------------------------------
# print_form is called from edit.cgi

sub generateContent {
	my($variables, $lang, $obj) = (shift, shift, shift);
	my $saved = $$variables->{saved} if exists $$variables->{saved};
	my $imgType = \$$variables->{imgType};
	my $skinPath = \$$variables->{skinPath};

	my $split = "255,255,255";
	my @@colors = split(/,/,$split);


print <<END ;
<br />
<table class="page_skeleton_ex" style='width:100%'>
<tr class="page_skeleton">
<td class="page_skeleton_ex" style='padding: 12px 10px 10px 10px'>



	<table style="text-align:center">
		<tr><td colspan='6' class='neutral_bold' style="text-align:left" class='nowrap'>$$lang->{'Format2d Color'}:</td></tr>
		<tr><td colspan='6'><hr /></td></tr>
		<tr>	<td id='color' class='cursor' style='background-color:rgb($split); width:50px; border:thin solid #424242' title='$split' onclick='addColor(this)' rowspan='2'>
				<img src='$${skinPath}img/color.$$imgType'>
				<input type='hidden' value='' id='takeColor' />
			</td>
			<td>&nbsp</td>
			<td style='text-align:right; color:#f00'>$$lang->{'Graph3d red'}</td>
			<td><img class='cursor' onclick='minus("red")' src='$${skinPath}img/downArr.$$imgType' onmousedown="startDecrease('red')" onmouseup='stopTimer()'></td>
			<td><input id='red' size='3' style='text-align:center' type='text' value='$colors[0]' onchange='changeColor()'/></td>
			<td><img onclick='plus("red")' class='cursor' style='padding:2px' src='$${skinPath}img/upArr.$$imgType' onmousedown="startIncrease('red')" onmouseup='stopTimer()'></td>
		</tr>
		<tr>
			<td>&nbsp</td>
			<td style='text-align:right; color:#0f0'>$$lang->{'Graph3d green'}</td><td><img class='cursor' onclick='minus("green")' src='$${skinPath}img/downArr.$$imgType' onmousedown="startDecrease('green')" onmouseup='stopTimer()'></td>
			<td><input id='green' type='text' style='text-align:center' size='3' value='$colors[1]' onchange='changeColor()'/></td>
			<td><img onclick='plus("green")' class='cursor' style='padding:2px' src='$${skinPath}img/upArr.$$imgType' onmousedown="startIncrease('green')" onmouseup='stopTimer()'></td>
		</tr><tr>
			<td>&nbsp</td>
			<td>&nbsp</td>
			<td style='text-align:right; color:#00f'>$$lang->{'Graph3d blue'}</td><td><img class='cursor' onclick='minus("blue")' src='$${skinPath}img/downArr.$$imgType' onmousedown="startDecrease('blue')" onmouseup='stopTimer()'></td>
			<td><input id='blue' type='text' style='text-align:center' size='3' value='$colors[2]' onchange='changeColor()'/></td>
			<td><img onclick='plus("blue")' class='cursor' style='padding:2px' src='$${skinPath}img/upArr.$$imgType' onmousedown="startIncrease('blue')" onmouseup='stopTimer()'></td>
		</tr>
	</table>
	<hr size='1' noshade='noshade' />
	<table style="text-align:center">
END
for my $row (0..6) {
	print "<tr>";
	for my $col (0..9) {
		print "<td title='${$Const::predefinedColors}[$row][$col]' onclick='setSelfColor(this)' style='background-color:rgb(${$Const::predefinedColors}[$row][$col]); width:12px; height:8px'></td>";
	}
	print "</tr>";
}
print <<END;
	</table>	



</td>
<td class="page_skeleton_ex" style='width:100%;padding:10px' rowspan='2' >


	<table	>
		<tr><td class='neutral_bold' colspan='2'>$$lang->{'Format2d Grid'}:</td></tr>
		<tr><td colspan='2'><hr /></td></tr>
END
foreach('bgclr','boxclr','fgclr','title','labels','axislabels'){
	my $name ="Format2d $_";
	if ( $_ eq 'bgclr') {
		my $check = ($$obj->{layout}{bg_transparent}) ? " checked='checked'" : "";
		print "<tr><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{$name} :</td><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{'Format2d transparent'}</td><td style='nowrap;padding:0px 10px 0px 0px'><input type='checkbox' id='bg_transparent' name='bg_transparent' $check value='1' onchange='object_changed()' /></td></tr>";
	}
	elsif ( $_ eq 'boxclr' ) {
		my $check = ($$obj->{layout}{show_boxclr}) ? " checked='checked'" : "";
		print "<tr><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{$name} :</td><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{'Format2d show'}</td><td style='nowrap;padding:0px 10px 0px 0px'><input name='show_boxclr' id='show_boxclr' type='checkbox' $check value='1' onchange='object_changed()' /></td></tr>";
	}
	elsif ( $_ eq 'fgclr' ) {
		my $check_ax = ($$obj->{layout}{show_axis}) ? " checked='checked'" : "";
		my $check_box = ($$obj->{layout}{show_axis_box}) ? " checked='checked'" : "";
		print "<tr><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{$name} :</td><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{'Format2d show'}</td><td style='nowrap;padding:0px 10px 0px 0px'><input name='show_axis' id='show_axis' type='checkbox' $check_ax value='1' onchange='object_changed()' /></td></tr>";
		print "<tr><td style='nowrap;padding:0px 10px 0px 0px'>&nbsp;</td><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{'Format2d show'} $$lang->{'Format2d box'} </td><td style='nowrap;padding:0px 10px 0px 0px'><input name='show_axis_box' id='show_axis_box' type='checkbox' $check_box value='1' onchange='object_changed()' /></td></tr>";
	}
	elsif ( $_ eq 'title' ) {
		my $check = ($$obj->{layout}{show_title}) ? " checked='checked'" : "";
		print "<tr><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{$name} :</td><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{'Format2d show'}</td><td style='nowrap;padding:0px 10px 0px 0px'><input name='show_title' id='show_title' type='checkbox' $check value='1' onchange='object_changed()' /></td></tr>";
	}
	elsif ( $_ eq 'labels' ) {
		my $check = ($$obj->{layout}{show_labels}) ? " checked='checked'" : "";
		print "<tr><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{$name} :</td><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{'Format2d show'}</td><td style='nowrap;padding:0px 10px 0px 0px'><input name='show_labels' id='show_labels' type='checkbox' $check value='1' onchange='object_changed()' /></td></tr>";
	}
	elsif ( $_ eq 'axislabels' ) {
		my $check = ($$obj->{layout}{show_axis_labels}) ? " checked='checked'" : "";
		print "<tr><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{$name} :</td><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{'Format2d show'}</td><td style='nowrap;padding:0px 10px 0px 0px'><input name='show_axis_labels' id='show_axis_labels' type='checkbox' $check value='1' onchange='object_changed()' /></td></tr>";
	}
	print "<tr><td style='nowrap;padding:0px 10px 0px 0px'><input name='$_' id='$_' onclick='setSelf(this)' type='hidden' value='$$obj->{layout}{$_}'/></td><td style='nowrap;padding:0px 10px 0px 0px'>$$lang->{'Format2d color'}</td><td class='cursor' id='color$_' onclick='reloadColor(this)' style='background-color:rgb($$obj->{layout}{$_}); width:25px; border:1px solid #424242'><img src='$${skinPath}img/smallcolor.$$imgType' /></td></tr>";
	print "<tr><td colspan='3'><hr size='1' noshade='noshade'/></td></tr>";
}
print <<END;	
	</table>


</td>
</tr>
<tr class="page_skeleton">
<td class="page_skeleton_ex" style='padding: 10px'>


	<table>
		<tr><td class='neutral_bold' colspan='3'>$$lang->{'Format2d Margin'}</td></tr>
		<tr><td colspan='3'><hr /></td></tr>
		<tr></tr>
		<tr><td class='wrap'>$$lang->{'Format2d axis_space'}:</td><td class='nowrap'><input class='right' type='input' size='4' name='axis_space' value='$$obj->{layout}{axis_space}' onchange='object_changed()' /> px</td></tr>
		<tr><td colspan='2'><hr size='1' noshade='noshade'/></td></tr>
		<tr><td class='wrap'>$$lang->{'Format2d text_space'}:</td><td class='wrap'><input class='right' type='input' size='4' name='text_space' value='$$obj->{layout}{text_space}' onchange='object_changed()' /> px</td></tr>
END
print <<END;
	</table>



</td>
</tr>
END



print <<END;
<tr class="page_skeleton" >
<td class="page_skeleton" colspan='2'>
	<table class="neutral_100">
		<tr><td align="center">
		<table class="buttons" cellpading="0" cellspacing="0">
		<tr>	<td class="buttons"><input id='SAVE' type="submit" name="Action" value="$$lang->{'Save'}"/></td>
			<td class="buttons">	<input type="submit" name="Action" value="$$lang->{'Save As'}" onclick="return readName();"/>
						<input type="hidden" name="saveAsName" id="saveAsName" value="" /></td>
			<td class="buttons"><input type="button" name="reset" value="$$lang->{'Reset'}" onclick="self.frames['format'].location.reload(true)"/></td>
		</tr>
		</table>
	</td></tr>
	</table>
</td></tr></table>
END



	print <<END;
<script type="text/javascript" src="js/format_color.js"></script>
<script type="text/javascript">
	var saveAsMsg = "$$lang->{SaveAsMsg}$$lang->{'New Format2d'}";
	reloadTree($saved);
	setResol();
	reSetIframe();
</script>
END

}

#---------------------------------------------------
sub set_next_param {
	my ($o,$q) = (shift, shift);
# save colors
	foreach ('bgclr','boxclr','fgclr','title','labels','axislabels') {
		$$o->{layout}{$_} = $$q->param($_) ;
	}
# save checkboxs	
	foreach ('bg_transparent','show_boxclr','show_axis','show_axis_box','show_title','show_labels','show_axis_labels') {
		$$o->{layout}{$_} = ($$q->param("$_")) ? $$q->param("$_") : 0;
	}
# save margins
	$$o->{layout}{axis_space} = $$q->param('axis_space');
	$$o->{layout}{text_space} = $$q->param('text_space');
}

1

@


1.2
log
@auto save when changing tabs implemented
@
text
@d4 1
a4 1
# $Id: Format2d_layout.pm,v 1.1 2003/10/31 12:47:57 jiri_schmid Exp $
d13 4
a16 2
my($variables, $lang, $obj) = (shift, shift, shift);
my $saved = $$variables->{saved} if exists $$variables->{saved};
d18 5
a22 1
print <<END;
d26 32
a57 5
<td class="page_skeleton_ex" style='padding: 10px'>
	<table>
		<tr><td class='neutral_bold' colspan='3'>$$lang->{'Format2d Margin'}:</td></tr>
		<tr><td colspan='3'><hr /></td></tr>
		<tr></tr>
d59 6
a64 4
foreach ('l_margin','r_margin','t_margin','b_margin') {
	my $name = "Format2d $_";
	my $add = "<td rowspan='4' style='vertical-align:top'>$$lang->{'Format2d Margin Border'}:</td>" if $_ eq 'l_margin';
	print "<tr>$add<td class='nowrap'>$$lang->{$name}:</td><td><input type='input' class='right' size='4' name='$_' value='$$obj->{layout}{$_}' onchange='object_changed()' /> px</td></tr>";
d67 4
a70 4
		<tr><td colspan='3'><hr size='1' noshade='noshade' /></td></tr>
		<tr><td rowspan='2' style='vertical-align:top' class='nowrap'>$$lang->{'Format2d Text'}:</td><td class='nowrap'>$$lang->{'Format2d Descr Value'}:</td><td class='nowrap'><input class='right' type='input' size='4' name='axis_space' value='$$obj->{layout}{axis_space}' /> px</td></tr>
		<tr><td class='nowrap'>$$lang->{'Format2d Descr Label'}:</td><td class='nowrap'><input class='right' type='input' size='4' name='text_space' value='$$obj->{layout}{text_space}' onchange='object_changed()' /> px</td></tr>
	</table>
d72 6
a77 4
<td class="page_skeleton_ex" style='padding: 10px; width:100%' rowspan='2'>
	<table>
		<tr><td class='neutral_bold' colspan='3'>$$lang->{'Format2d Label'}:</td></tr>
		<tr><td colspan='3'><hr /></td></tr>
d79 30
a108 4
foreach ('x_label_position','y_label_position') {
	my $name = "Format2d $_";
	my $hlp = ($_ =~ /^x/) ? 'Format2d Label Horizontal' : 'Format2d Label Vertical';
	print "<tr><td class='nowrap'>$$lang->{$hlp}:</td><td style='font-size:75%'>$$lang->{$name}</td><td><input class='right' type='input' size='4' name='$_' value='$$obj->{layout}{$_}' onchange='object_changed()' /></td></tr>";
d110 1
a110 12
print "<tr><td colspan='3'><hr size='1' noshade='noshade' /></td></tr>";
foreach ('x_plot_values','x_labels_vertical','y_plot_values') {
	my $name = "Format2d $_";
	my $check = ($$obj->{layout}{$_}) ? " checked='checked'" : "";
	print "<tr><td colspan='2' class='nowrap'>$$lang->{$name}:</td><td><input type='checkbox' name='$_'$check value='1' onchange='object_changed()' /></td></tr>";
}
print "<tr><td colspan='3'><hr size='1' noshade='noshade' /></td></tr>";
foreach ('x_label_skip','x_tick_offset','y_label_skip') {
	my $name = "Format2d $_";
	print "<tr><td colspan='2' class='nowrap'>$$lang->{$name}:</td><td><input class='right' type='input' size='4' name='$_' value='$$obj->{layout}{$_}' onchange='object_changed()' /></td></tr>";
}
print <<END;
d112 2
d116 1
a116 1
<tr class="page_skeleton" >
d118 2
d121 6
a126 2
		<tr><td class='neutral_bold' colspan='2'>$$lang->{'Format2d Grid'}:</td></tr>
		<tr><td colspan='2'><hr /></td></tr>
a127 5
foreach ('x_long_ticks','y_long_ticks') {
	my $name = "Format2d $_";
	my $check = ($$obj->{layout}{$_}) ? " checked='checked'" : "";
	print "<tr><td class='nowrap'>$$lang->{$name}:</td><td><input type='checkbox' name='$_'$check value='1' onchange='object_changed()'/></td></tr>";
}
d130 3
d135 5
d154 6
d163 2
d167 1
d173 11
a183 4
foreach ('l_margin','r_margin','t_margin','b_margin','x_label_position','y_label_position','axis_space','text_space','x_labels_vertical','x_long_ticks','y_long_ticks','y_plot_values','x_plot_values','x_label_skip','y_label_skip','x_tick_offset') {
	$$o->{layout}{$_} = ($$q->param($_)) ? $$q->param($_) : undef;
}
	
d187 1
@


1.1
log
@mod perl rocks!
@
text
@d4 1
a4 1
# $Id: format2d_layout_ed.pl,v 1.6 2003/10/16 14:08:53 jiri_schmid Exp $
d29 1
a29 1
	print "<tr>$add<td class='nowrap'>$$lang->{$name}:</td><td><input type='input' class='right' size='4' name='$_' value='$$obj->{layout}{$_}' /> px</td></tr>";
d34 1
a34 1
		<tr><td class='nowrap'>$$lang->{'Format2d Descr Label'}:</td><td class='nowrap'><input class='right' type='input' size='4' name='text_space' value='$$obj->{layout}{text_space}' /> px</td></tr>
d45 1
a45 1
	print "<tr><td class='nowrap'>$$lang->{$hlp}:</td><td style='font-size:75%'>$$lang->{$name}</td><td><input class='right' type='input' size='4' name='$_' value='$$obj->{layout}{$_}' /></td></tr>";
d51 1
a51 1
	print "<tr><td colspan='2' class='nowrap'>$$lang->{$name}:</td><td><input type='checkbox' name='$_'$check value='1' /></td></tr>";
d56 1
a56 1
	print "<tr><td colspan='2' class='nowrap'>$$lang->{$name}:</td><td><input class='right' type='input' size='4' name='$_' value='$$obj->{layout}{$_}' /></td></tr>";
d71 1
a71 1
	print "<tr><td class='nowrap'>$$lang->{$name}:</td><td><input type='checkbox' name='$_'$check value='1' /></td></tr>";
d82 2
a83 2
		<tr>	<td class="buttons"><input type="submit" name="Action" value="$$lang->{'Save'}"/></td>
				<td class="buttons">	<input type="submit" name="Action" value="$$lang->{'Save As'}" onclick="return readName();"/>
@

